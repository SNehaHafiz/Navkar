
@{
    ViewBag.Title = "Rebate Bill verification";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}


<style>
    .table thead th, .text-wrap table thead th {
        background-color: #9f78ff;
        color: white;
    }

    table.table-bordered.dataTable tbody th, table.table-bordered.dataTable tbody td {
        color: black;
        font-weight: 900 !important;
        font-size: 15px !important;
    }
</style>

<script src="~/js/GetTableJsonwopaging.js"></script>
<div id="tracker-loader"></div>

<div class="content-area overflow-hidden" id="divmainsummary">
    <div>
        <div class="page-header">
            <h4 class="page-title">Rebate Bill Verification</h4>
            <div class="form-group">
                <label class="form-label"></label>
                <div class="row gutters-xs">
                    <div class="col">

                        <button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="ViewSummary();"><i class="fa fa-file-text"></i></button>


                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <div class="row">

                    <div class="col-sm-12 col-lg-6">
                        <div class="row">
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">verify No</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("TxtBillNoNew", "New", new { @class = "form-control", @id = "TxtBillNoNew", @name = "TxtBillNoNew", autocomplete = "off", @placeHolder = "2020-21", @readonly = true })


                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Bill Year</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("TxtBillYear", "2020-21", new { @class = "form-control", @id = "TxtBillYear", @name = "TxtBillYear", autocomplete = "off", @placeHolder = "2020-21" })


                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Bill No</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("TxtBillno", null, new { @class = "form-control", @id = "TxtBillno", @name = "TxtBillno", autocomplete = "off" })


                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Bill Date</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("TxtBillDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy 08:00") })


                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-1 col-lg-1">
                                <div class="form-group label-floating" style="padding-top:26px">
                                    <button class="btn btn-primary" id="TripSearch" type="button" data-toggle="modal" data-target="#smallModal" onclick="LoadModel()"><i class="fe fe-search"></i></button>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Bill Type</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlbilltype", (IEnumerable<SelectListItem>)ViewBag.Billtype, "--Select-- ", new { @class = "form-control", @id = "ddlbilltype", name = "ddlbilltype", autocomplete = "off" })

                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-6 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Party Name</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @*@Html.DropDownList("ddlpartyname", (IEnumerable<SelectListItem>)ViewBag.Customer, "--Select-- ", new { @class = "form-control", @id = "ddlpartyname", name = "ddlpartyname", autocomplete = "off" })*@

                                            <input type="text" class="form-control" id="ddlpartyname" />
                                            <input type="hidden" class="form-control" id="hdnPayFromId" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Container No</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("Txtcontainerno", null, new { @class = "form-control", @id = "Txtcontainerno", @name = "Txtcontainerno", autocomplete = "off", style = "text-transform: uppercase;", maxlength = 11 })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <label style="font-weight:bold">OR</label>
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">BL No</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("TxtBLNo", null, new { @class = "form-control", @id = "TxtBLNo", @name = "TxtBLNo", autocomplete = "off" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Paid Amount</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("Txtpaidamt", null, new { @class = "form-control", @id = "Txtpaidamt", @name = "Txtpaidamt", autocomplete = "off" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-1 col-sm-12" id="divSBAdd">
                                <div class="form-group" style="padding-top:25px">
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <button class="btn btn-white" type="button" id="btnAddSBNo" style="border-color:black" name="Add" onclick="GetmanualDetails()"><i class="fa fa-check"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        @*<div class="row">

                                <div class="col-lg-4 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label mandatory">Paid Amount</label>
                                        <div class="row gutters-xs">
                                            <div class="col">
                                                @Html.TextBox("Txtpaidamt", null, new { @class = "form-control", @id = "Txtpaidamt", @name = "Txtpaidamt", autocomplete = "off" })
                                            </div>
                                        </div>
                                    </div>
                                </div>



                            </div>*@

                    </div>
                    <div class="col-sm-12 col-lg-6">
                        <div class="row">
                            <div class="col-lg-8 col-sm-12">
                                <div class="form-group" style="padding-top:20px">
                                    <label class="form-label mandatory">select .xls file from which Container(s) to be imported.</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input type="file" id="fileImport" name="postedFile" class="btn btn-primary" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group" style="padding-top:20px">
                                    <label class="form-label mandatory" style="visibility:hidden">d</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <button class="btn btn-primary" id="btnImport" type="button">Import</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2" style="padding-top:20px">
                                <label class="form-label mandatory" style="visibility:hidden">d</label>
                                <a href='@Url.Action("DownloadIMGTemplateOnly", "loadingplan")' title="Download Excel" class="btn btn-warning"><i class="fa fa-download"></i></a>

                                @*@Html.ActionLink("Download Template", "DownloadIMGTemplateOnly", null, new { @class = "btn btn-primary btn-md" })*@

                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 col-sm-12">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover tbl-cart text-nowrap" id="example4" style="width:100%;background-color:#f4f5fa !important;">
                                        <thead>
                                            <tr>
                                                <th class="wd-10p sorting" style="background-color:yellow">Container No.</th>
                                                <th class="wd-10p sorting" style="background-color:yellow">Amount</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                        <td class="wd-10p sorting">BMOU2003377</td>
                                        <td class="wd-10p sorting">1000</td>
                                        </tbody>
                                        <tbody>
                                        <td class="wd-10p sorting">CMAU1072099</td>
                                        <td class="wd-10p sorting">2000</td>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-lg-2 col-sm-2">
                                <div class="form-group label-floating">
                                    <label class="form-label">20's</label>
                                    @Html.TextBox("lbltwenty", null, new { @class = "form-control", @id = "lbltwenty", name = "lbltwenty", autocomplete = "off", style = "text-align:right;background-color:#9f78ff;color:white", @readonly = "readonly" })
                                </div>
                            </div>
                            <div class="col-md-2 col-lg-2">
                                <div class="form-group label-floating">
                                    <label class="form-label">40's</label>
                                    @Html.TextBox("lblforty", null, new { @class = "form-control", @id = "lblforty", name = "lblforty", autocomplete = "off", style = "text-align:right;background-color:#fdb901;color:white", @readonly = "readonly" })
                                </div>
                            </div>
                            <div class="col-md-2 col-lg-2">
                                <div class="form-group label-floating">
                                    <label class="form-label">45's</label>
                                    @Html.TextBox("lblfortyfive", null, new { @class = "form-control", @id = "lblfortyfive", name = "lblfortyfive", autocomplete = "off", style = "text-align:right;background-color:#32cafe;color:white", @readonly = "readonly" })
                                </div>
                            </div>
                            <div class="col-md-2 col-lg-2">
                                <div class="form-group label-floating">
                                    <label class="form-label">Teus</label>
                                    @Html.TextBox("lblTotal", null, new { @class = "form-control", @id = "lblTotal", name = "lblTotal", autocomplete = "off", style = "text-align:right;background-color:#5ed84f;color:white", @readonly = "readonly" })
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-12 col-lg-12">
                        <div class="row">
                            <div class="col-lg-12 col-sm-12">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover tbl-cart text-nowrap" id="example1" style="width:100%;">
                                        <thead>
                                            <tr>
                                                <th class="wd-10p sorting">Select</th>
                                                <th class="wd-10p sorting">Sr No</th>
                                                <th class="wd-10p sorting">Container No</th>
                                                <th class="wd-10p sorting ">JO No.</th>
                                                <th class="wd-10p sorting">JO Type</th>
                                                <th class="wd-10p sorting">Size</th>
                                                <th class="wd-10p sorting">Type</th>
                                                <th class="wd-10p sorting">INDate and Time</th>
                                                <th class="wd-10p sorting">Line Name</th>

                                                <th class="wd-10p sorting">Customer Nmae</th>
                                                <th class="wd-10p sorting">Is DPD</th>
                                                <th class="wd-10p sorting">Is UB</th>
                                                <th class="wd-10p sorting">Paid Amount</th>
                                                <th class="wd-10p sorting">Line ID</th>


                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <br /><br />
                <div class="row">
                    <div class="col-lg-2 col-sm-12">
                        <div class="form-group">
                            <label class="form-label mandatory" style="visibility:hidden">Net</label>
                            <div class="row gutters-xs">
                                <div class="col">
                                    <label class="custom-control custom-checkbox">
                                        <input id="lifecheck" type="checkbox" class="custom-control-input" onclick="gettotal()">

                                        <span class="custom-control-label" style="font-weight:bold">Is GST applicable ?.</span>
                                    </label>

                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-2 col-sm-12">
                        <div class="form-group">
                            <label class="form-label mandatory">Net Amount</label>
                            <div class="row gutters-xs">
                                <div class="col">
                                    @Html.TextBox("TxtNewpaid", null, new { @class = "form-control", @id = "TxtNewpaid", @name = "TxtNewpaid", autocomplete = "off", Onchange = "gettotal()", @type = "number", style = "text-align:right;" })


                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-12">
                        <div class="form-group">
                            <label class="form-label mandatory">SGST</label>
                            <div class="row gutters-xs">
                                <div class="col">
                                    @Html.TextBox("TxtSGST", null, new { @class = "form-control", @id = "TxtSGST", @name = "TxtSGST", autocomplete = "off", Onchange = "gettotal()", @type = "number", style = "text-align:right;" })

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-12">
                        <div class="form-group">
                            <label class="form-label mandatory">CGST</label>
                            <div class="row gutters-xs">
                                <div class="col">
                                    @Html.TextBox("TxtCGST", null, new { @class = "form-control", @id = "TxtCGST", @name = "TxtCGST", autocomplete = "off", Onchange = "gettotal()", @type = "number", style = "text-align:right;" })

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-12">
                        <div class="form-group">
                            <label class="form-label mandatory">IGST</label>
                            <div class="row gutters-xs">
                                <div class="col">
                                    @Html.TextBox("TxtIGST", null, new { @class = "form-control", @id = "TxtIGST", @name = "TxtIGST", autocomplete = "off", Onchange = "gettotal()", @type = "number", style = "text-align:right;" })

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-12">
                        <div class="form-group">
                            <label class="form-label mandatory">Grand Total</label>
                            <div class="row gutters-xs">
                                <div class="col">
                                    @Html.TextBox("TxtGrandtotal", null, new { @class = "form-control", @id = "TxtGrandtotal", @name = "TxtGrandtotal", autocomplete = "off", @readonly = true, style = "text-align:right;" })

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-1 col-xs-4">
                        <div class="form-group">
                            <div class="row gutters-xs">
                                <div class="col">
                                    <button class="btn btn-success btn-xs" id="btndriverholdpayment" onclick="SaveDetails();">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class=" content-area" id="Divsummary" style="display:none">
    <div class="page-header">
        <h4 class="page-title">Rebate Bill Verification Summary</h4>
        <div class="ibox-content  text-right">
            <a onclick="getBack();" class="btn btn-primary btn-success" style="color:white;align-content:center;"><i class="fa fa-arrow-left" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Back"></i>  </a></li>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-3 col-sm-12">
            <div class="form-group">
                <label class="form-label">Search</label>
                <div class="row gutters-xs">
                    <div class="col">
                        @Html.DropDownList("--Select--", new List<SelectListItem>
                          { new SelectListItem { Text = "ALL", Value = "ALL"},
                              new SelectListItem { Text = "Container No", Value = "Container No"},

                            new SelectListItem { Text = "Party Name", Value = "Party Name"},
                            new SelectListItem { Text = "Bill Type", Value = "Bill Type"},
                            }, new { @class = "form-control", autocomplete = "off", @id = "ddlsummarysearchcerteria" })
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-2 col-sm-12" id="divsearchtext" style="display:none">
            <div class="form-group">
                <label class="form-label" id="lblgetlable"></label>
                <div class="row gutters-xs">
                    <div class="col">
                        @Html.TextBox("txtSearchtext", null, new { @class = "form-control ", @id = "txtSearchtext", autocomplete = "off" })
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-sm-12" style="display:none" id="divparty">
            <div class="form-group">
                <label class="form-label mandatory">Party Name</label>
                <div class="row gutters-xs">
                    <div class="col">
                        @Html.DropDownList("ddlpartynamesummary", (IEnumerable<SelectListItem>)ViewBag.Customer, "--Select-- ", new { @class = "form-control", @id = "ddlpartynamesummary", name = "ddlpartynamesummary", autocomplete = "off" })


                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-sm-12" style="display:none" id="divbilltype">
            <div class="form-group">
                <label class="form-label mandatory">Bill Type</label>
                <div class="row gutters-xs">
                    <div class="col">
                        @Html.DropDownList("ddlbilltypesearch", (IEnumerable<SelectListItem>)ViewBag.Billtype, "--Select-- ", new { @class = "form-control", @id = "ddlbilltypesearch", name = "ddlbilltypesearch", autocomplete = "off" })

                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-2 col-sm-12">
            <div class="form-group">
                <label class="form-label">From Date</label>
                <div class="row gutters-xs">
                    <div class="col">
                        @Html.TextBox("txtSummaryFromDate", null, new { @class = "form-control form_datetime1 ", @id = "txtSummaryFromDate", autocomplete = "off", @Value = DateTime.Now.ToString("dd MMM yyyy 00:00") })
                    </div>

                </div>
            </div>
        </div>
        <div class="col-lg-2 col-sm-12">
            <div class="form-group">
                <label class="form-label">To Date</label>
                <div class="row gutters-xs">
                    <div class="col">
                        @Html.TextBox("txtSummaryToDate", null, new { @class = "form-control form_datetime1 ", @id = "txtSummaryToDate", autocomplete = "off", @Value = DateTime.Now.ToString("dd MMM yyyy 23:59") })
                    </div>

                </div>
            </div>
        </div>
        <div class="col-lg-2 col-sm-12">
            <div class="form-group">
                <label class="form-label" style="visibility:hidden">.</label>
                <div class="row gutters-xs">
                    <div class="col">
                        <button type="button" class="btn btn-icon btn-primary" name="clearProfile" title="clear" id="btnShow" onclick="getSummarydetails()">Show</button>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-1 col-sm-1">
                            <div class="form-group label-floating">
                                <label class="form-label">20's</label>
                                @Html.TextBox("Txt20", null, new { @class = "form-control", @id = "Txt20", name = "Txt20", autocomplete = "off", style = "text-align:right;background-color:#9f78ff;color:white", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="col-md-1 col-lg-1">
                            <div class="form-group label-floating">
                                <label class="form-label">40's</label>
                                @Html.TextBox("Txt40", null, new { @class = "form-control", @id = "Txt40", name = "Txt40", autocomplete = "off", style = "text-align:right;background-color:#fdb901;color:white", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="col-md-1 col-lg-1">
                            <div class="form-group label-floating">
                                <label class="form-label">45's</label>
                                @Html.TextBox("Txt45", null, new { @class = "form-control", @id = "Txt45", name = "Txt45", autocomplete = "off", style = "text-align:right;background-color:#32cafe;color:white", @readonly = "readonly" })
                            </div>
                        </div>
                        <div class="col-md-1 col-lg-1">
                            <div class="form-group label-floating">
                                <label class="form-label">Teus</label>
                                @Html.TextBox("TxtTeus", null, new { @class = "form-control", @id = "TxtTeus", name = "TxtTeus", autocomplete = "off", style = "text-align:right;background-color:#5ed84f;color:white", @readonly = "readonly" })
                            </div>
                        </div>
                    </div>
                    @Html.ActionLink("Export To Excel", "ExportToExcelRebateBilldetails", null, new { @class = "btn btn-primary btn-md" })
                    <br />
                    <div class="row">
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover tbl-cart text-nowrap" id="tblReceiptSummaryDet"></table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal  fade" id="smallModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" id='myModalContent'>
            <div class=" content-area" id="diventry">
                <div class="page-header">
                    <h4 class="page-title">Bill No Details </h4>

                </div>
                <div class="row">
                    <div class="col-md-12 col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="col-lg-3 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label mandatory">Search</label>
                                        <div class="row gutters-xs">
                                            <div class="col">

                                                <input id="TXtSearch" type="text" class="form-control" onchange="GetBilldetails()" />


                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12 col-lg-12">

                                        <div class="table-responsive">
                                            <table class="table table-bordered table-hover tbl-cart text-nowrap" id="example2" style="width:100%">
                                                <thead>
                                                    <tr></tr>
                                                </thead>

                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- table-wrapper -->
                    </div>
                    <!-- section-wrapper -->
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function gettotal() {
        var netpaid = $("#TxtNewpaid").val();
        var SGST = $("#TxtSGST").val();
        var CGST = $("#TxtCGST").val();
        var IGST = $("#TxtIGST").val();

        if (netpaid == "") {
            netpaid = 0;
        }
        if (SGST == "") {
            SGST = 0;
        }
        if (CGST == "") {
            CGST = 0;
        }
        if (IGST == "") {
            IGST = 0;
        }

        var isGST = document.getElementById("lifecheck").checked;


        if (isGST == true) {
            var dblSBCCess = 9;
            var dblServiceTax = 9;
            var dblKKCess = 9;
            CGST = parseFloat(netpaid) * parseFloat(dblSBCCess) / 100;

            IGST = 0;

            SGST = parseFloat(netpaid) * parseFloat(dblServiceTax) / 100;

            $("#TxtSGST").val(SGST.toFixed(2));
            $("#TxtCGST").val(CGST.toFixed(2));
            $("#TxtIGST").val(IGST.toFixed(2));

            $("#TxtGrandtotal").val((parseFloat(netpaid) + parseFloat(SGST) + parseFloat(CGST) + parseFloat(IGST)).toFixed(2));
        }
        else {
            $("#TxtGrandtotal").val((parseFloat(netpaid) + parseFloat(SGST) + parseFloat(CGST) + parseFloat(IGST)).toFixed(2));
        }





    }
</script>
<script type="text/javascript">

    $(window).on("load", function (e) {
        $("#tracker-loader").fadeOut("slow");
    })

    $(document).ready(function () {
        $('#example4').DataTable({
            "bLengthChange": false,
            "bInfo": false,
            "bPaginate": false,
            "bFilter": false,
            "paging": false


        });



    });

    $(document).ready(function () {
        $('#example1').DataTable({
            "bLengthChange": false,
            "bInfo": false,
            "bPaginate": false,
            //"bFilter": false,
            "paging": false


        });



    });
</script>
<script>
    $(document).ready(function () {
        $('#btnImport').click(function () {
            $("#tracker-loader").fadeIn("slow");
            //$("#tracker-loader").fadeIn("slow");

            if (window.FormData !== undefined) {

                var fileUpload = $("#fileImport").get(0);
                var files = fileUpload.files;

                // Create FormData object


                var r = confirm("You have chosen to Container  Details from Specified Excel File.  " + files[0].name + " Are you sure?!");
                if (r == true) {


                    var fileData = new FormData();
                    if (files.length == 0) {
                        alert("Please select File!")
                        $("#tracker-loader").fadeOut("slow");
                        return false;
                    }
                    else {
                        // Looping over all files and add it to FormData object
                        for (var i = 0; i < files.length; i++) {

                            fileData.append(files[i].name, files[i]);
                        }


                        // Adding one more key to FormData object
                        //  fileData.append('TDSValue', tdstype);


                        $.ajax({
                            url: '/loadingplan/AjaxImportRedatebillverificaiton',
                            type: "POST",
                            contentType: false, // Not to set any content header
                            processData: false, // Not to process data
                            data: fileData,
                            success: function (data) {

                                if (data.ContainerError != null) {
                                    alert(data.ContainerError)
                                    $("#tracker-loader").fadeOut("slow");
                                }
                                if (data.tabledata != "") {

                                    $('#example1').dataTable({
                                        "destroy": true,
                                        "bLengthChange": false,
                                        //"bPaginate": true,
                                        //  "bFilter": false,
                                        "paging": false,
                                        "aaData": data.tabledata,
                                        "columns": [
                                            {
                                                "data": "SrNo",
                                                "render": function (data, type, row, meta) {
                                                    if (type === 'display') {

                                                        data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\" checked  value="' + row.SrNo + '">';
                                                    }

                                                    return data;
                                                }
                                            },
                                            { "data": "SrNo" },
                                            { "data": "ContainerNo" },
                                            { "data": "JONo" },
                                            { "data": "JOType" },
                                            { "data": "Size" },
                                            { "data": "Type" },
                                            { "data": "INDateandTime" },
                                            { "data": "LineName" },

                                            { "data": "CustomerNmae" },
                                            { "data": "IsDPD" },

                                            { "data": "IsUB" },
                                            { "data": "PaidAmount" },
                                            { "data": "Lineid" },

                                        ],

                                    })


                                    var table = document.getElementById("example1");
                                    var row;


                                    var TotTEUS1 = 0;
                                    var TotTEUS2 = 0;
                                    var TotTEUS3 = 0;
                                    var TotTEUS = 0;
                                    var AmountTotal = 0;

                                    for (var i = 1; i < table.rows.length; i++) {
                                        row = table.rows[i];
                                        //var Size = row.cells[6].childNodes[1].value;
                                        var Size = row.cells[5].innerText;
                                        var Amount = row.cells[12].innerText;

                                        //alert(Size)

                                        if (Size == 20) {
                                            TotTEUS1 = Number(TotTEUS1) + 1;
                                        }
                                        if (Size == 40) {
                                            TotTEUS2 = Number(TotTEUS2) + 1;
                                        }
                                        if (Size == 45) {
                                            TotTEUS3 = Number(TotTEUS3) + 1;
                                        }
                                        //TotTEUS = Number(TotTEUS) + Number(size);
                                        AmountTotal = Number(AmountTotal) + Number(Amount);
                                    }
                                    TotTEUS = TotTEUS1 + (TotTEUS2 * 2) + (TotTEUS3 * 2)
                                    // alert(TotTEUS);
                                    $("#lbltwenty").val(TotTEUS1);
                                    $("#lblforty").val(TotTEUS2);
                                    $("#lblfortyfive").val(TotTEUS3);
                                    $("#lblTotal").val(TotTEUS);
                                    $("#TxtNewpaid").val(AmountTotal);
                                    $("#tracker-loader").fadeOut("slow");

                                }

                            },
                            error: function (error) {
                                let str = error.responseText;
                                var a = str.indexOf("<title>") + 7;
                                var b = str.indexOf("</title>");
                                str = str.substring(a, b);
                                alert("Something went wrong: " + str);
                                $("#tracker-loader").fadeIn("slow");
                            }

                        });
                    }
                } else {

                    alert("You Pressed Cancel!");
                    $("#tracker-loader").fadeOut("slow");
                }




            }
            else {
                alert("FormData is not supported.");
                $("#tracker-loader").fadeOut("slow");
            }
            $("#fileImport").val('');

        });

    });
</script>
<script>
    function SaveDetails() {
        var res = validation();
        if (res == false) {
            return false;
        }
        $("#tracker-loader").fadeIn("slow");
        var BillYear = $("#TxtBillYear").val();
        var BillNo = $("#TxtBillno").val();
        var BillType = $("#ddlbilltype option:selected").text();
        var PartyName = $("#hdnPayFromId").val();
        var netpaid = $("#TxtNewpaid").val();
        var SGST = $("#TxtSGST").val();
        var CGST = $("#TxtCGST").val();
        var IGST = $("#TxtIGST").val();
        var Grandtotal = $("#TxtGrandtotal").val();
        var isGSqT = document.getElementById("lifecheck").checked;
        var isGST = 0;

        if (isGSqT == true) {
            isGST = 1;
        } else {
            isGST = 0;
        }



        var itemcount = checkItemcount();
        if (itemcount == false) {
            alert("No details selected for saving. Cannot proceed");
        }
        else {
            var checkboxarray = [];
            $('input[type=checkbox]').each(function () {
                if (this.checked) {

                    checkboxarray.push($(this).val());
                }
            });

            var tablearray = [];
            var table = document.getElementById("example1");
            var row;
            for (var i = 1; i < table.rows.length; i++) {

                row = table.rows[i];




                for (var k = 0; k < checkboxarray.length; k++) {


                    var InvoiceNo = row.cells[1].innerText;

                    if (InvoiceNo == checkboxarray[k]) {



                        row = table.rows[i];
                        Srno1 = row.cells[1].innerText;
                        ContainerNo = row.cells[2].innerText;
                        ContainerNo1 = row.cells[2].innerText;
                        JONo = row.cells[3].innerText;
                        JOType = row.cells[4].innerText;
                        Size = row.cells[5].innerText;
                        Type = row.cells[6].innerText;
                        INDateandTime = row.cells[7].innerText;
                        LineName = row.cells[8].innerText;
                        CustomerNmae = row.cells[9].innerText;
                        IsDPD = row.cells[10].innerText;
                        IsUB = row.cells[11].innerText;
                        PaidAmount = row.cells[12].innerText;
                        Lineid = row.cells[13].innerText;





                        for (var z = 0; z < tablearray.length; z++) {

                            var tempExp = tablearray[z].ContainerNo;

                            if (tempExp == ContainerNo1) {
                                alert("duplicate container no found " + ContainerNo1 + " where [SR NO] =  " + Srno1 +"");
                                $("#tracker-loader").fadeOut("slow");
                                return false;
                            }
                        }


                            tablearray.push({
                                'ContainerNo': ContainerNo, 'JONo': JONo, 'JOType': JOType,
                                'Size': Size, 'Type': Type, 'INDateandTime': INDateandTime, 'LineName': LineName, 'CustomerNmae': CustomerNmae, 'IsDPD': IsDPD,
                                'IsUB': IsUB, 'PaidAmount': PaidAmount, 'Lineid': Lineid
                            })




                    }
                }
            }
            var data1 = {
                'SlipNoList': tablearray, 'BillYear': BillYear, 'BillNo': BillNo, 'BillType': BillType, 'PartyName': PartyName, 'netpaid': netpaid, 'SGST': SGST, 'CGST': CGST, 'IGST': IGST, 'Grandtotal': Grandtotal, 'isGST': isGST

            }
            var data = JSON.stringify(data1);


            $.ajax({
                url: "/LoadingPlan/SaveRebatebillverirication",
                data: data,
                type: "POST",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {


                    if (data != null) {
                        alert(data);
                        $("#tracker-loader").fadeOut("slow");
                    }


                    if (data == "Record Saved Successfully!") {
                        document.location = '@Url.Action("ReDateBillverification", "loadingplan")';
                        $("#tracker-loader").fadeOut("slow");
                    }



                },

                error: function (error) {
                    let str = error.responseText;
                    var a = str.indexOf("<title>") + 7;
                    var b = str.indexOf("</title>");
                    str = str.substring(a, b);
                    alert("Something went wrong: " + str);
                    $("#tracker-loader").fadeOut("slow");
                }
            });

        }
    }


    function validation() {

        var billno = document.getElementById('TxtBillno').value;
        var billyear = document.getElementById('TxtBillYear').value;
        var billtype = document.getElementById('ddlbilltype').value;
        var Partyname = document.getElementById('ddlpartyname').value;
        var b1result = Boolean;
        blResult = true;

        document.getElementById('TxtBillno').style.borderColor = "Gainsboro";
        document.getElementById('TxtBillYear').style.borderColor = "Gainsboro";
        document.getElementById('ddlbilltype').style.borderColor = "Gainsboro";
        document.getElementById('ddlpartyname').style.borderColor = "Gainsboro";
        if (billno == "") {
            document.getElementById('TxtBillno').style.borderColor = "red"
            blResult = blResult && false;
        }
        if (billyear == "") {
            document.getElementById('TxtBillYear').style.borderColor = "red"
            blResult = blResult && false;
        }
        if (billtype == "") {
            document.getElementById('ddlbilltype').style.borderColor = "red"
            blResult = blResult && false;
        }

        if (Partyname == "") {
            document.getElementById('ddlpartyname').style.borderColor = "red"
            blResult = blResult && false;
        }

        if (blResult == false) { alert('Please fill the required fields!'); }
        return blResult;

    }
    function checkItemcount() {

        var table = $('#example1').DataTable();

        if (table.rows().count() == 0) {

            return false;
        }
        return true;

    }

    //function checkItemcount() {



    //}
</script>
<script>
    function GetmanualDetails() {
        $("#tracker-loader").fadeIn("slow");

        document.getElementById('TxtBLNo').style.borderColor = "Gainsboro";
        document.getElementById('Txtcontainerno').style.borderColor = "Gainsboro";
        document.getElementById('Txtpaidamt').style.borderColor = "Gainsboro";
        document.getElementById('ddlpartyname').style.borderColor = "Gainsboro";


        var BillYear = $("#TxtBillYear").val();
        var BillNo = $("#TxtBillno").val();
        var BillType = $("#ddlbilltype option:selected").val();
        var PartyName = $("#ddlpartyname option:selected").val();
        var netpaid = $("#TxtNewpaid").val();
        var SGST = $("#TxtSGST").val();
        var CGST = $("#TxtCGST").val();
        var IGST = $("#TxtIGST").val();
        var Grandtotal = $("#TxtGrandtotal").val();
        var Containerno = $("#Txtcontainerno").val();
        var BLNO = $("#TxtBLNo").val();
        var paidamt = $("#Txtpaidamt").val();


        if (PartyName == "") {
            document.getElementById('ddlpartyname').style.borderColor = "red"
            alert("Please enter party Name!");
            $("#tracker-loader").fadeOut("slow");
            return false
        }
        if (paidamt == "") {
            document.getElementById('Txtpaidamt').style.borderColor = "red"
            alert("Please enter Amount!");
            $("#tracker-loader").fadeOut("slow");
            return false
        }
        if (Containerno == "" && BLNO == "") {
            document.getElementById('TxtBLNo').style.borderColor = "red"
            document.getElementById('Txtcontainerno').style.borderColor = "red"
            alert("Please enter BL/Container No!");
            $("#tracker-loader").fadeOut("slow");
            return false
        }








        var data1 = { 'BillYear': BillYear, 'BillNo': BillNo, 'BillType': BillType, 'Containerno': Containerno, 'BLNO': BLNO, 'paidamt': paidamt, 'PartyName': PartyName };
        var datac = JSON.stringify(data1);



        $.ajax({
            url: "/LoadingPlan/CheckBlandContainerno",
            data: '{Containerno: ' + JSON.stringify(Containerno) + ',BLNO: ' + JSON.stringify(BLNO) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {

                if (data == "") {
                    $.ajax({
                        url: "/LoadingPlan/CheckMaualdetails",
                        data: datac,
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (data) {


                            if (data.ContainerError != null) {
                                alert(data.ContainerError)
                                $("#tracker-loader").fadeOut("slow");
                            }
                            if (data.tabledata != "") {

                                $('#example1').dataTable({
                                    "destroy": true,
                                    "bLengthChange": false,
                                    //"bPaginate": true,
                                    //  "bFilter": false,
                                    "paging": false,
                                    "aaData": data.tabledata,
                                    "columns": [
                                        {
                                            "data": "SrNo",
                                            "render": function (data, type, row, meta) {
                                                if (type === 'display') {

                                                    data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\" checked  value="' + row.SrNo + '">';
                                                }

                                                return data;
                                            }
                                        },
                                        { "data": "SrNo" },
                                        { "data": "ContainerNo" },
                                        { "data": "JONo" },
                                        { "data": "JOType" },
                                        { "data": "Size" },
                                        { "data": "Type" },
                                        { "data": "INDateandTime" },
                                        { "data": "LineName" },

                                        { "data": "CustomerNmae" },
                                        { "data": "IsDPD" },

                                        { "data": "IsUB" },
                                        { "data": "PaidAmount" },
                                        { "data": "Lineid" },
                                    ],



                                })

                                var table = document.getElementById("example1");
                                var row;

                                if (table.length > 0) {
                                    var TotTEUS1 = 0;
                                    var TotTEUS2 = 0;
                                    var TotTEUS3 = 0;
                                    var TotTEUS = 0;
                                    var AmountTotal = 0;

                                    for (var i = 1; i < table.rows.length; i++) {
                                        row = table.rows[i];
                                        //var Size = row.cells[6].childNodes[1].value;
                                        var Size = row.cells[5].innerText;
                                        var Amount = row.cells[12].innerText;

                                        //alert(Size)

                                        if (Size == 20) {
                                            TotTEUS1 = Number(TotTEUS1) + 1;
                                        }
                                        if (Size == 40) {
                                            TotTEUS2 = Number(TotTEUS2) + 1;
                                        }
                                        if (Size == 45) {
                                            TotTEUS3 = Number(TotTEUS3) + 1;
                                        }
                                        //TotTEUS = Number(TotTEUS) + Number(size);

                                        AmountTotal = Number(AmountTotal) + Number(Amount);
                                    }
                                    TotTEUS = TotTEUS1 + (TotTEUS2 * 2) + (TotTEUS3 * 2)
                                    // alert(TotTEUS);
                                    $("#lbltwenty").val(TotTEUS1);
                                    $("#lblforty").val(TotTEUS2);
                                    $("#lblfortyfive").val(TotTEUS3);
                                    $("#lblTotal").val(TotTEUS);
                                    $("#TxtNewpaid").val(AmountTotal);
                                }

                                $("#tracker-loader").fadeOut("slow");

                            }
                        },

                        error: function (error) {
                            let str = error.responseText;
                            var a = str.indexOf("<title>") + 7;
                            var b = str.indexOf("</title>");
                            str = str.substring(a, b);
                            alert("Something went wrong: " + str);
                            $("#tracker-loader").fadeOut("slow");
                        }
                    });
                }
                else {
                    alert(data);
                    $("#tracker-loader").fadeOut("slow");
                    return false
                }

            },

            error: function (error) {
                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);
                $("#tracker-loader").fadeOut("slow");
            }
        })


    }
</script>

<script>
    function ViewSummary() {
        $("#divmainsummary").hide();
        $("#Divsummary").show();
    }

    function getBack() {
        $("#divmainsummary").show();
        $("#Divsummary").hide();
    }


    $('#ddlsummarysearchcerteria').change(function (e) {
        var SearchNO = $("#ddlsummarysearchcerteria").val();
        // alert(SearchNO);
        if (SearchNO == "ALL") {
            $("#lblgetlable").text("ALL");
            $("#divsearchtext").hide();
            $("#divparty").hide();
            $("#txtSearchtext").val("");
            $("#divbilltype").hide();
        }
        if (SearchNO == "Container No") {
            $("#divsearchtext").show();
            $("#lblgetlable").text("Container No");
            $("#txtSearchtext").val("");
            $("#divparty").hide();
            $("#divbilltype").hide();
        }

        if (SearchNO == "Party Name") {
            $("#divsearchtext").hide();
            $("#divparty").show();
            $("#divbilltype").hide();

            $("#txtSearchtext").val("");
        }

        if (SearchNO == "Bill Type") {
            $("#divsearchtext").hide();
            $("#divparty").hide();
            $("#divbilltype").show();

            $("#txtSearchtext").val("");
        }




    });

    function getSummarydetails() {
        $("#tracker-loader").fadeIn("slow");
        var SearchNO = $("#ddlsummarysearchcerteria").val();
        var searchcerteria = $("#ddlsummarysearchcerteria").val();
        var Searchtext = "";
        var FromDate = $("#txtSummaryFromDate").val();
        var ToDate = $("#txtSummaryToDate").val();

        if (SearchNO == "Container No") {
            var Searchtext = $("#txtSearchtext").val();
        }

        if (SearchNO == "Party Name") {
            var Searchtext = $("#ddlpartynamesummary option:selected").text()
        }

        if (SearchNO == "Bill Type") {
            var Searchtext = $("#ddlbilltypesearch option:selected").text()
        }

        $.ajax({
            url: '/Loadingplan/AjaxGetRebatedetails',
            type: 'Post',
            data: '{FromDate: ' + JSON.stringify(FromDate) + ', ToDate: ' + JSON.stringify(ToDate) + ', searchcerteria: ' + JSON.stringify(searchcerteria) + ', Searchtext: ' + JSON.stringify(Searchtext) + '}',

            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                debugger;
                if (data == "0" || data == "[]") {
                    //  ControlCtrl.TableReceiptSummaryDet.empty();
                    alert('No data found.');
                    $("#tracker-loader").fadeOut("slow");
                }
                $("#tblReceiptSummaryDet").empty();
                RepTableDataJsonwopaging($("#tblReceiptSummaryDet"), data, "Voucher Details", "VoucherDetails_List");


                var table = document.getElementById("tblReceiptSummaryDet");
                var row;


                var TotTEUS1 = 0;
                var TotTEUS2 = 0;
                var TotTEUS3 = 0;
                var TotTEUS = 0;


                for (var i = 1; i < table.rows.length; i++) {
                    row = table.rows[i];
                    //var Size = row.cells[6].childNodes[1].value;
                    var Size = row.cells[6].innerText;


                    //alert(Size)

                    if (Size == 20) {
                        TotTEUS1 = Number(TotTEUS1) + 1;
                    }
                    if (Size == 40) {
                        TotTEUS2 = Number(TotTEUS2) + 1;
                    }
                    if (Size == 45) {
                        TotTEUS3 = Number(TotTEUS3) + 1;
                    }
                    //TotTEUS = Number(TotTEUS) + Number(size);


                }
                TotTEUS = TotTEUS1 + (TotTEUS2 * 2) + (TotTEUS3 * 2)
                // alert(TotTEUS);
                $("#Txt20").val(TotTEUS1);
                $("#Txt40").val(TotTEUS2);
                $("#Txt45").val(TotTEUS3);
                $("#TxtTeus").val(TotTEUS);



                $("#tracker-loader").fadeOut("slow");
                //RepTableDataJson($(ControlCtrl.TableReceiptSummaryDet), data, "Receipt Summary", "ReceiptSummaryDet");
            },
            error: function (errormessage) {
                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);
                $("#tracker-loader").fadeOut("slow");
            }
        });
    };

</script>

<script>
    $(document).ready(function () {
        AutomCom();

    });
    function AutomCom() {

        $("#ddlpartyname").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/LoadingPlan/getAutoCustomerList",
                    data: "{ 'prefixText': '" + request.term + "'}",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        //debugger;
                        response($.map(data, function (item) {
                            //debugger;
                            return {
                                label: item.AGName,
                                val: item.AGID
                            };
                        }))
                    },
                    error: function (response) {
                        alert(response.responseText);
                    },
                    failure: function (response) {
                        alert(response.responseText);
                    }
                })
            },
            select: function (e, i) {
                //debugger;
                $("#ddlpartyname").val(i.item.label);
                $("#hdnPayFromId").val(i.item.val);
            },
            minLength: 1
        });
    };
</script>

<script>
    function LoadModel() {

        $('#smallModal').modal('show');
        GetBilldetails();
    }


    function GetBilldetails() {
        $("#tracker-loader").fadeIn("slow");
        var Searchtype= $("#TXtSearch").val();

        $.ajax({
            url: '/Loadingplan/RebateBill_Search',
            type: 'Post',
            data: '{Searchtype: ' + JSON.stringify(Searchtype) + '}',

            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                if (data == "0" || data == "[]") {
                    //  ControlCtrl.TableReceiptSummaryDet.empty();
                    alert('No data found.');
                    $("#tracker-loader").fadeOut("slow");
                }
                $("#example2").empty();
                RepTableDataJsonwopaging($("#example2"), data, "Voucher Details", "VoucherDetails_List");






                $("#tracker-loader").fadeOut("slow");
                //RepTableDataJson($(ControlCtrl.TableReceiptSummaryDet), data, "Receipt Summary", "ReceiptSummaryDet");
            },
            error: function (errormessage) {
                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);
                $("#tracker-loader").fadeOut("slow");
            }
        });
    }



    function SelectData(BillNo, BillID, BillYear, GrandAmt, EntryDate) {


        $("#TxtBillYear").val(BillYear);
        $("#TxtBillno").val(BillNo);
        $("#ddlbilltype").val(BillID);

        $("#Txtpaidamt").val(GrandAmt);
        $("#TxtBillDate").val(EntryDate);

        $('#smallModal').modal('hide');
    }
</script>