
@{
    ViewBag.Title = "Customer Tariff Master";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}
<script src="~/js/GetTableJson.js"></script>

<script src="~/js/GetTableJsonwopaging.js"></script>
<div class="content-area overflow-hidden" id="divmainsummary">
    <div>
        <div class="page-header">
            <h4 class="page-title">Transport Tariff Master</h4>
            <div class="form-group">
                <label class="form-label"></label>
                <div class="row gutters-xs">
                    <div class="col">

                        <button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="summary();"><i class="fa fa-file-text"></i></button>


                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
              
                 
                        <div class="row">
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Tariff ID </label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input ID="txtTariffID" type="text" placeholder="New" readonly="readonly" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Description</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input ID="txtDescription" type="text" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>





                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Shipping Line</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlshippingline", (IEnumerable<SelectListItem>)ViewBag.ShippingLineList, "--Select--", new { @class = "form-control", @id = "ddlshippingline", name = "ddlshippingline" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">CHA Name</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlCHA", (IEnumerable<SelectListItem>)ViewBag.CHA, "--Select--", new { @class = "form-control", @id = "ddlCHA", name = "ddlCHA" })
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Customer</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlcustomer", (IEnumerable<SelectListItem>)ViewBag.CustomerList, "--Select--", new { @class = "form-control", @id = "ddlcustomer", name = "ddlcustomer" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Importer</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlConsignee", (IEnumerable<SelectListItem>)ViewBag.Consignee, "--Select--", new { @class = "form-control", @id = "ddlConsignee", name = "ddlConsignee" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Tariff Group</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlTariffGroup", (IEnumerable<SelectListItem>)ViewBag.TariffGroup, "--Select--", new { @class = "form-control", @id = "ddlTariffGroup", name = "ddlTariffGroup" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">

                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">From Date</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("txtFromDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy HH:mm") })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label"> To Date</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("txtToDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.AddDays(365).ToString("dd MMM yyyy HH:mm") })
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Free Day</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input ID="txtday" type="text" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-1 col-xs-12">
                                <div class="form-group">
                                    <label class="form-label mandatory" style="visibility:hidden">.</label>
                                    <label class="custom-switch">
                                        <input type="checkbox" name="custom-switch-checkbox" id="chkIsActiveEdit" checked class="custom-switch-input">
                                        <span class="custom-switch-indicator"></span>
                                        <span class="custom-switch-description">Is Active?</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label"></label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @*<input type="submit" id="Save" name="save" value="Save" class="btn btn-success" />*@
                                            <button id="btnSave" class="btn btn-success btn-xs" onclick="return Save();">Save</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <input type="button" name="clear" value="Clear" class="btn btn-default" title="clear" id="clearValue" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                   

              
                </div>
        </div>
    </div>
</div>


<div class=" content-area" id="divsummary" style="display:none">
    <div class="page-header">
        <h4 class="page-title">Transport Account Master List</h4>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a onclick="Back();" class="btn btn-primary btn-success text-right" style="align-content:center;color:white"><i class="fa fa-arrow-left" data-placement="bottom" title="Add Work Order"></i> </a>
            </li>
        </ol>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="form-horizontal">

                        <div class="row">

                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Search</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @*@Html.EditorFor(model => model.CHACode, new { htmlAttributes = new { @class = "form-control", @id = "chaCode", autocomplete = "off", maxlength = 20 } })*@
                                            @Html.TextBox("txtsearch", null, new { @class = "form-control ", @id = "txtsearch", name = "txtsearch", autocomplete = "on" })
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label" style="visibility:hidden"> '</label>
                                    <div class="row gutters-xs">
                                        <div class="col">

                                            <button class="btn btn-primary" id="TripSearch" type="button" onclick="Showdetails()"><i class="fe fe-search"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @Html.ActionLink("Export To Excel", "ExportToExcelImportAccountMaster", null, new { @class = "btn btn-primary btn-md" })
                        <div class="row">
                            <div class="col-lg-12 col-sm-12">
                                <div class="table-responsive">
                                    <table id="example2" class="table table-bordered table-hover tbl-cart text-nowrap" style="width:100%">
                                        <thead>

                                            <tr></tr>
                                        </thead>

                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function summary() {
        $("#divmainsummary").hide();
        $("#divsummary").show();
    }
    function Back() {
        $("#divmainsummary").show();
        $("#divsummary").hide();
    }
    $(window).on("load", function (e) {
     
        $("#ddlshippingline").val(233);
        $("#ddlCHA").val(1);
        $("#ddlcustomer").val(61);
        $("#ddlConsignee").val(1);
    })
</script>
<script type="text/javascript">

    function Showdetails() {
        $("#tracker-loader").fadeIn("slow");
        
       
     

        $.ajax({
            type: 'POST',
            url: '/ImportInvoice/GetImportTariffSettingSummary',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (jsonResult) {
            
                $("#example2").empty();
                RepTableDataJson($("#example2"), jsonResult, "Voucher Details", "VoucherDetails_List");
                $("#tracker-loader").fadeOut("slow");
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });
    }
</script>
<script>

      function Save() {
        
        var txtDescription = document.getElementById('txtDescription').value;
      





        var datac = {
            'TariffDescription': txtDescription
        };
          var data = JSON.stringify(datac);

          var TariffID = document.getElementById('txtTariffID').value;

          if (TariffID == "") {


              $.ajax({
                  url: "/ImportInvoice/CheckTariffMasterAlready",
                  data: data,
                  type: "POST",
                  contentType: "application/json; charset=utf-8",
                  // dataType: "json",
                  success: function (data) {
                      if (data != "Account name already exits!") {
                          Save1();
                      } else {
                          alert(data);
                      }

                  },

                  error: function (errormessage) {
                      alert(errormessage.responseText);
                  }
              });

          } else {
              Save1();
          }

    }


    function Save1() {
        var res = validateSaveFunctions();
        if (res == false) {
            return false;
        }
        var TariffID = document.getElementById('txtTariffID').value;
        var txtDescription = document.getElementById('txtDescription').value;
        var ddlshippingline = document.getElementById('ddlshippingline').value;
        var ddlCHA = document.getElementById('ddlCHA').value;
        var ddlcustomer = document.getElementById('ddlcustomer').value;
        var ddlConsignee = document.getElementById('ddlConsignee').value;
        var ddlTariffGroup = document.getElementById('ddlTariffGroup').value;
        var txtFromDate = document.getElementById('txtFromDate').value;
        var txtToDate = document.getElementById('txtToDate').value;
        var txtday = document.getElementById('txtday').value;
        if (txtday == "") {
            txtday = 0; 
        }





        var datac1 = {
            'TariffDescription': txtDescription, 'EffectiveFrom': txtFromDate, 'EffectiveUpto': txtToDate, 'ToShippingLine': 0, 'ToCHA': 0, 'Rebate20': 0,
            'Rebate40': 0, 'RebatePercentage': 0, 'RebateOther20': 0, 'RebateOther40': 0, 'RebateOtherPercentage': 0,
            'discPercent': 0, 'LineID': ddlshippingline, 'CHAId': ddlCHA, 'CustomerID': ddlcustomer, 'ImporterID': ddlConsignee, 'IsActive': 1,
            'isDPD': 0, 'IsPreferred': 0, 'Port': 0, 'Jotype': 0, 'FreeDay': txtday, 'Tariff_Group_ID': ddlTariffGroup, 'TariffID': TariffID
        };
        var datac = JSON.stringify(datac1);

        //alert(datac);


        $.ajax({
            url: "/ImportInvoice/SaveImportTariff",
            data: datac,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            // dataType: "json",
            success: function (response) {

                alert("Record saved successfully!");
                document.location = '@Url.Action("ImportTariffMaster", "ImportInvoice")';

            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });


    }



    function EditTariffMaster(entryid, tariffID, TariffDescription, lineid, chaid, customerid, importerid, tariff_group_id, EffectiveFROM, EffectiveUpto, FreeDay) {
        $("#divmainsummary").show();
        $("#divsummary").hide();
      

        document.getElementById('txtDescription').value = TariffDescription;
        document.getElementById('txtTariffID').value = tariffID;
        document.getElementById('ddlshippingline').value = lineid;
        document.getElementById('ddlCHA').value = chaid;
        document.getElementById('ddlcustomer').value = customerid;
        document.getElementById('ddlConsignee').value = importerid;
        document.getElementById('ddlTariffGroup').value = tariff_group_id;
        document.getElementById('txtFromDate').value = EffectiveFROM;
        document.getElementById('txtToDate').value = EffectiveUpto;
        document.getElementById('txtday').value = FreeDay;
       
      
        
    }

</script>
<script>
        function validateSaveFunctions() {

            var txtdrivername = document.getElementById('txtDescription').value;
            var shipping = document.getElementById('ddlshippingline').value;
            var cha = document.getElementById('ddlCHA').value;
            var customer = document.getElementById('ddlcustomer').value;
            var Consignee = document.getElementById('ddlConsignee').value;




            document.getElementById("txtDescription").style.borderColor = "gainsboro";
            document.getElementById("ddlshippingline").style.borderColor = "gainsboro";
            document.getElementById("ddlCHA").style.borderColor = "gainsboro";
            document.getElementById("ddlcustomer").style.borderColor = "gainsboro";
            document.getElementById("ddlConsignee").style.borderColor = "gainsboro";


            var blResult = Boolean;
            blResult = true;


            if (txtdrivername == "") {
                //  document.getElementById('ContainerNo').style.borderColor = "red"
                document.getElementById("txtDescription").style.borderColor = "red";
                blResult = blResult && false;
            }
            if (shipping == "") {
                //  document.getElementById('ContainerNo').style.borderColor = "red"
                document.getElementById("ddlshippingline").style.borderColor = "red";
                blResult = blResult && false;
            }
            if (cha == "") {
                //  document.getElementById('ContainerNo').style.borderColor = "red"
                document.getElementById("ddlCHA").style.borderColor = "red";
                blResult = blResult && false;
            }
            if (customer == "") {
                //  document.getElementById('ContainerNo').style.borderColor = "red"
                document.getElementById("ddlcustomer").style.borderColor = "red";
                blResult = blResult && false;
            }
            if (Consignee == "") {
                //  document.getElementById('ContainerNo').style.borderColor = "red"
                document.getElementById("ddlConsignee").style.borderColor = "red";
                blResult = blResult && false;
            }
            if (blResult == false) { alert('Please fill the required fields!'); }
            return blResult;

        };


    </script>
