
@{
    ViewBag.Title = "Import Work Order";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}
<script src="~/js/GetTableJsonPagging.js"></script>
<div id="tracker-loader"></div>
<div class=" content-area" id="diventrytable">
    <div class="page-header">
        <h4 class="page-title">Generate Work Order (Import) </h4>
        <div class="form-group">
            <label class="form-label"></label>
            <div class="row gutters-xs">
                <div class="col">
                    <button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="ViewSummaryVehicle();"><i class="fa fa-file-text"></i></button>

                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="form-horizontal">
                        <div class="row">
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Wo No</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.Editor("TXtEntryid", new { htmlAttributes = new { @class = "form-control", @id = "TXtEntryid", @readonly = "readonly", @placeholder = "New" } })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">WO Date</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("TxtDestuffDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.AddDays(0).ToString("dd MMM yyyy 08:00") })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-lg-3">
                                <div class="form-group label-floating">
                                    <label class="form-label">Category</label>
                                    @*@Html.TextBox("txtOrigin", null, new { @class = "form-control", @id = "txtOrigin", name = "txtOrigin", autocomplete = "off", rows = "2", @maxlength = 500 })*@
                                    @Html.DropDownList("ddlCategory", new List<SelectListItem>
                                         { new SelectListItem { Text = "Import", Value = "Import"},
                                         
                                           }, new { @class = "form-control", autocomplete = "off", @id = "ddlCategory" })
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12">
                                <label class="form-label">WO Type </label>
                                <select id="ddlWOType" class="form-control">
                                    <option value="Loaded To Destuff">Loaded To Destuff</option>
                                    <option value="Dock Destuff Delivery">Dock Destuff Delivery</option>
                                </select>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-sm-12 col-lg-4">
                                <div class="form-group label-floating">
                                    <label class="form-label">Search On</label>
                                    @*@Html.TextBox("txtOrigin", null, new { @class = "form-control", @id = "txtOrigin", name = "txtOrigin", autocomplete = "off", rows = "2", @maxlength = 500 })*@
                                    @Html.DropDownList("ddlSearchOn", new List<SelectListItem>
                                         {new SelectListItem { Text = "select", Value = "0"},


                                             new SelectListItem { Text = "IGM-Item No", Value = "IGM-Item No"},
                                             new SelectListItem { Text = "Container", Value = "Container"},

                                           }, new { @class = "form-control", autocomplete = "off", @id = "ddlSearchOn" })
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12" style="display:none" id="DivContainer">
                                <div class="form-group">
                                    <label class="form-label mandatory">Search</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("txtContainerNo", null, new { @class = "form-control", @id = "txtContainerNo", name = "txtContainerNo", autocomplete = "off", placeholder = "Search", @maxlength = 22 })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12" style="display:none" id="DivIGM">
                                <div class="form-group">
                                    <label class="form-label">IGM No.</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.Editor("TxtIgmno", new { htmlAttributes = new { @class = "form-control", @id = "TxtIgmno" } })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-1 col-sm-12" style="display:none" id="divItemNo">
                                <div class="form-group">
                                    <label class="form-label">Item No.</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.Editor("TxtItemNo", new { htmlAttributes = new { @class = "form-control", @id = "TxtItemNo" } })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 col-xs-4">
                                <div class="form-group">
                                    <label class="form-label" style="visibility:hidden">.</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <button class="btn btn-primary" id="Save" title="Show" onclick="showdetails();"><i class="fa fa-search"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">CHA</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.Editor("txtCHA", new { htmlAttributes = new { @class = "form-control", @id = "txtCHA", autocomplete = "off" } })
                                            <input id="lblCHAID" style="visibility:hidden" />
                                            <input id="lblNocNo" style="visibility:hidden" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Consignee</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.Editor("TxtConsignee", new { htmlAttributes = new { @class = "form-control", @id = "TxtConsignee", autocomplete = "off" } })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Cargo Desc</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.Editor("TxtCargoDesc", new { htmlAttributes = new { @class = "form-control", @id = "TxtCargoDesc", autocomplete = "off" } })

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4 col-sm-12" style="display:none">
                                <div class="form-group">
                                    <label class="form-label">Vendor</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlvendorname", (IEnumerable<SelectListItem>)ViewBag.VendorName, "--Select-- ", new { @class = "form-control", @id = "ddlvendorname", name = "ddlvendorname", autocomplete = "off" })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Surveyor</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.DropDownList("ddlSurveyor", (IEnumerable<SelectListItem>)ViewBag.Surveyor, "--Select-- ", new { @class = "form-control", @id = "ddlSurveyor", name = "ddlSurveyor", autocomplete = "off" })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label">Do Validate </label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("txtDoValidate", null, new { @class = "form-control datePickerPOD", @Value = DateTime.Now.AddDays(0).ToString("dd MMM yyyy") })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label" style="visibility:hidden"> '</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <span style="font-weight: bold"> 20 :</span> <label id="lbltwenty" style="font-weight: bold"></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <span style="font-weight: bold"> 40 :</span> <label id="lblforty" style="font-weight: bold"></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <span style="font-weight: bold"> 45 :</span> <label id="lblfortyfive" style="font-weight: bold"></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <span style="font-weight: bold"> TEUS :</span>   <label id="lblTotal" style="font-weight: bold"></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;




                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-lg-12 col-sm-12">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-hover tbl-cart text-nowrap" id="example1">
                                        <thead>
                                            <tr>
                                                <th><input type="checkbox" id="flowcheckall" value="" />&nbsp;Select</th>
                                                <th class="wd-15p sorting">Jo No</th>
                                                <th class="wd-15p sorting">Container No</th>
                                                <th class="wd-15p sorting">Size</th>
                                                <th class="wd-15p sorting">Delivery Type</th>
                                                <th class="wd-15p sorting">IGm Qty</th>
                                                <th class="wd-15p sorting">Weight</th>
                                                <th class="wd-15p sorting">Unit</th>
                                                <th class="wd-15p sorting"> Qty</th>
                                                <th class="wd-15p sorting">Weight</th>
                                                <th class="wd-15p sorting">Examine%</th>
                                                <th class="wd-15p sorting">Entry ID</th>
                                                <th class="wd-15p sorting">Equipment Type</th>
                                                <th class="wd-15p sorting">Remakrs</th>
                                                <th class="wd-15p sorting">Hours</th>
                                                <th class="wd-15p sorting">CBM</th>
                                                <th class="wd-15p sorting">Vehicle No</th>
                                                <th class="wd-15p sorting">Material Qty</th>
                                                <th class="wd-15p sorting">Material Descriptions</th>
                                                <th class="wd-15p sorting">Copy</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-1 col-xs-4" id="divsave">
                                <div class="form-group">
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <button class="btn btn-success" title="Save" id="Save" onclick="Save();">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-1 col-xs-4" id="divclosed" style="display:none">
                                <div class="form-group">
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <button class="btn btn-success" title="Save" id="Save" onclick="editclosed();">closed</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-1 col-xs-4">
                                <div class="form-group">
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <button class="btn btn-gray" id="Save" title="Clear" onclick="Clear();">Clear</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class=" content-area" id="divviewdetails" style="display:none">
    <div class="page-header">
        <h4 class="page-title">List of Open Work Orders(Import) </h4>
        <div class="ibox-content  text-right">
            <a onclick="getBack();" class="btn btn-primary btn-success" style="color:white;align-content:center;"><i class="fa fa-arrow-left" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Back"></i>  </a></li>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12 col-sm-12">
            <div class="card">
                <div class="card-body">


                    <div class="row">
                        <div class="col-sm-12 col-lg-2">
                            <div class="form-group label-floating">
                                <label class="form-label">Search On</label>
                                @*@Html.TextBox("txtOrigin", null, new { @class = "form-control", @id = "txtOrigin", name = "txtOrigin", autocomplete = "off", rows = "2", @maxlength = 500 })*@
                                @Html.DropDownList("ddlSearchOnsummary", new List<SelectListItem>
                                     {new SelectListItem { Text = "select", Value = "0"},
                               new SelectListItem { Text = "ALL", Value = "ALL"},
                                         new SelectListItem { Text = "IGM-Item No", Value = "IGM-Item No"},
                                                                             new SelectListItem { Text = "Container No", Value = "Container No"},

                                       }, new { @class = "form-control", autocomplete = "off", @id = "ddlSearchOnsummary" })
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12" style="display:none" id="DivIGM1">
                            <div class="form-group">
                                <label class="form-label">IGM No.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.Editor("TxtIgmnoView", new { htmlAttributes = new { @class = "form-control", @id = "TxtIgmnoView", autocomplete = "off" } })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-1 col-sm-12" style="display:none" id="divItemNo1">
                            <div class="form-group">
                                <label class="form-label">Item No.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.Editor("TxtItemNoView", new { htmlAttributes = new { @class = "form-control", @id = "TxtItemNoView", autocomplete = "off" } })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12" style="display:none" id="divContainerNo">
                            <div class="form-group">
                                <label class="form-label">Container No.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.Editor("txtContainer", new { htmlAttributes = new { @class = "form-control", @id = "txtContainer", autocomplete = "off" } })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2 col-xs-4">
                            <div class="form-group">
                                <label class="form-label" style="visibility:hidden">.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <button class="btn btn-primary" id="Save" title="Show" onclick="ViewSummary();"><i class="fa fa-search"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <button class="btn btn-orange" id="btnSearch" type="button"><i class="fa fa-file-excel-o" onclick="GetExcelFile()"></i></button>
                            <div class="table-responsive">
                                <table class="table table-bordered table-hover tbl-cart text-nowrap" id="TblViewSummarydetails"></table>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    //$('#ddlCategory').change(function (e) {
    //    var Worktype = $("#ddlCategory option:selected").val();
    //    $.ajax({
    //        url: "/exportModel/AjaxGetWorkOrdertype",
    //        data: '{Worktype: ' + JSON.stringify(Worktype) + '}',
    //        type: "POST",
    //        contentType: "application/json; charset=utf-8",
    //        dataType: "json",
    //        success: function (data) {

    //            var select = $("#ddlWOType");

    //            select.empty();
    //            select.append($('<option/>', {
    //                value: "",
    //                text: "--Select--"
    //            }));

    //            $.each(data, function (data, value) {

    //                select.append($("<option></option>").val(value.CategoryName).html(value.CategoryName));
    //            })





    //        },

    //        error: function (errormessage) {
    //            alert(errormessage.responseText);
    //        }
    //    });

    //});

    function getcategorytype() {

        var Worktype = $("#ddlCategory option:selected").val();

        $.ajax({
            url: "/exportModel/AjaxGetWorkOrdertype",
            data: '{Worktype: ' + JSON.stringify(Worktype) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {

                var select = $("#ddlWOType");

                select.empty();
                select.append($('<option/>', {
                    value: "",
                    text: "--Select--"
                }));

                $.each(data, function (data, value) {

                    select.append($("<option></option>").val(value.CategoryName).html(value.CategoryName));
                })





            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }
</script>
<script type="text/javascript">
$("#ddlSearchOn").click(function () {

        var ddlSearchOn = $("#ddlSearchOn").val();
    if (ddlSearchOn == "Container"  ) {
            $("#DivContainer").show();
            $("#DivIGM").hide();
            $("#divItemNo").hide();
        }

        if (ddlSearchOn == "IGM-Item No") {
            $("#DivContainer").hide();
            $("#DivIGM").show();
            $("#divItemNo").show();
    }
    if (ddlSearchOn == "EX_BOENO") {
        $("#DivContainer").show();
        $("#DivIGM").hide();
        $("#divItemNo").hide();
    }
    if (ddlSearchOn == "NOC_BOENO") {
        $("#DivContainer").show();
        $("#DivIGM").hide();
        $("#divItemNo").hide();
    }
    });

    $("#ddlSearchOnsummary").click(function () {

        var ddlSearchOn = $("#ddlSearchOnsummary").val();
        if (ddlSearchOn == "IGM-Item No") {

            $("#DivIGM1").show();
            $("#divItemNo1").show();
        }
        if (ddlSearchOn == "ALL") {

            $("#DivIGM1").hide();
            $("#divItemNo1").hide();
            $("#divContainerNo").hide();
        }
        if (ddlSearchOn == "Container No") {

            $("#DivIGM1").hide();
            $("#divItemNo1").hide();
            $("#divContainerNo").show();
            
        }
    });

    $(document).ready(function () {
        $('#example1').DataTable({
            "bLengthChange": false,
            "bInfo": false,
            "bPaginate": false,
            "bFilter": false,
            "paging": false,
            "bPaginate": false,

        });



    });
    $(window).on("load", function (e) {
        $("#tracker-loader").fadeOut("slow");

        $("#ddlvendorname").val(1);

     
        //getcategorytype();
    })
       function GetExcelFile() {

        window.location = '@Url.Action("ExportToExcelGetWorkorder", "ExportModel")?';


    }
    $('#ddlsummarysearchcerteria').change(function (e) {
        var SearchNO = $("#ddlsummarysearchcerteria").val();

        if (SearchNO == "Container No") {
            $("#lblgetlable").text("Container No");
            $("#divsearchtext").show();
            $("#divIgmno").hide();
            $("#divItemnno").hide();
            $("#divcha").hide();
            $("#divCustomerName").hide();
            $("#divfrom").hide();
            $("#divto").hide();
            $("#txtSearchtext").val('');
        }

        if (SearchNO == "Igm-Item No") {
            $("#lblgetlable").text("IGM No");
            $("#lblitemno").text("Item No");

            $("#divsearchtext").show();
            $("#divItemnno").show();
            $("#divcha").hide();
            $("#divCustomerName").hide();
            $("#divfrom").hide();
            $("#divto").hide();
            $("#txtIgmno").val('');
            $("#txtSearchtext").val('');
        }
        if (SearchNO == "ALL") {
            $("#divfrom").show();
            $("#divto").show();
            $("#divsearchtext").hide();
            $("#divItemnno").hide();
            $("#divcha").hide();
            $("#divCustomerName").hide();

        }
        if (SearchNO == "CHA Name") {
            $("#divfrom").hide();
            $("#divto").hide();
            $("#divsearchtext").hide();
            $("#divItemnno").hide();
            $("#divcha").show();
            $("#divCustomerName").hide();

        }
        if (SearchNO == "Customer") {
            $("#divfrom").hide();
            $("#divto").hide();
            $("#divsearchtext").hide();
            $("#divItemnno").hide();
            $("#divcha").hide();
            $("#divCustomerName").show();

        }

    });</script>
<script>


    var EquipmentL = [];

    EquipmentLs = @Html.Raw(Json.Encode(@ViewBag.Equi));
    EquipmentL = JSON.parse(EquipmentLs);



    function showdetails() {

        var SearchOn = $("#ddlSearchOn").val();



        if (SearchOn == "Container") {
            var ContainerNo = $("#txtContainerNo").val(); 
        }

        if (SearchOn == "IGM-Item No") {
            var Igmno = $("#TxtIgmno").val();
            var ItemNo = $("#TxtItemNo").val();
        }
       

       
        var data1 = { 'Igmno': Igmno, 'ItemNo': ItemNo, 'ContainerNo': ContainerNo };
        var data = JSON.stringify(data1);

        $.ajax({
            type: 'POST',
            url: '/exportModel/GetCheckIgmItemno',
            data: data,
            // data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function (data) {
                if (data != 0) {
                    alert('Specified container already have in Work Order . Cannot proceed.')
                }
                else {
                    showdetailscheck();
                }

            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });
    }


    function showdetailscheck() {
        debugger;
         
        var Category = $("#ddlWOType").val();
        var SearchOn = $("#ddlSearchOn").val();
        
        if (SearchOn == "Container") {
            var ContainerNo = $("#txtContainerNo").val();
        }

        if (SearchOn == "IGM-Item No") {
            var Igmno = $("#TxtIgmno").val();
            var ItemNo = $("#TxtItemNo").val();
        }


        
       

        var data1 = { 'ContainerNo': ContainerNo, 'Igmno': Igmno, 'ItemNo': ItemNo, 'Category': Category, 'SearchOn': SearchOn };
        var data = JSON.stringify(data1);

        $.ajax({
            type: 'POST',
            url: '/exportModel/AjxImportWorkDetails',
            data: data,
            // data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function (data) {



                $("#TxtConsignee").val(data.List1.Consignee);
                $("#TxtCargoDesc").val(data.List1.IGM_GoodsDesc);
                $("#txtCHA").val(data.List1.CHAName);
                $("#lblCHAID").val(data.List1.CHAID);
                $("#lblNocNo").val(data.List1.NocNo);
                    //$("#").val(IGM_BLNo);
                    //$("#").val(IGM_PackType);
                    //$("#").val(IGM_GrossVol);
                    //$("#").val(IGM_GrossWt);
                    //$("#").val(IGM_WtUnit);



                    $('#example1').dataTable({
                        "destroy": true,
                        "bLengthChange": false,
                        "bPaginate": false,
                        //"bFilter": false,
                        "paging": false,
                        "order": false,
                        "aaData": data.List2,
                        "columns": [
                            {

                                "data": "Select",
                                "render": function (data, type, row, meta) {

                                    data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\"  checked value="' + row.EntryID + '">';
                                    return data;

                                }
                            },
                            { "data": "JONo" },
                            { "data": "Containerno" },
                            { "data": "Size" },
                            { "data": "DeliveryType" },
                            { "data": "IGMQty" },
                            { "data": "Weight" },
                            { "data": "Unit" },
                            {

                                "data": "DestuffQty",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"TxtDestuff' + row.EntryID + '\" class=\"form-control\" id=\"TxtDestuff' + row.EntryID + '\" onchange=\" ChkAmtValidate(this)\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },
                            {

                                "data": "ShortQty",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"TxtShortQty' + row.EntryID + '\" class=\"form-control\" id=\"TxtShortQty' + row.EntryID + '\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },
                            {

                                "data": "Examine",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"textExamine' + row.EntryID + '\" class=\"form-control\" id=\"textExamine' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },

                            { "data": "EntryID" },


                            {
                                "data": "Equipment",
                                "render": function (data, type, row, meta) {

                                    data = '<select  class="form-control" id="Equipment' + row.EntryID + '"  style="width:100px">'
                                    for (j = 0; j < EquipmentL.length; j++) {

                                        data += '<option value="' + EquipmentL[j].EnID + '"> ' + EquipmentL[j].EquipmentType + '</option>'

                                    }

                                    data += '</select>';
                                    return data;

                                }

                            },
                            {

                                "data": "Remarks",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"textRemarks' + row.EntryID + '\" class=\"form-control\" id=\"textRemarks' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },
                            {

                                "data": "Hours",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"textHours' + row.EntryID + '\" class=\"form-control\" id=\"textHours' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },

                            {

                                "data": "CGM",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"textCGM' + row.EntryID + '\" class=\"form-control\" id=\"textCGM' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },
                            {

                                "data": "VehicleNo",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"textVehicleNo' + row.EntryID + '\" class=\"form-control\" id=\"textVehicleNo' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },
                            {

                                "data": "MaterialQty",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"txtMaterialQty' + row.EntryID + '\" class=\"form-control\" id=\"txtMaterialQty' + row.EntryID + '\" style=\"width:100px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },
                            {

                                "data": "MaterialDescriptions",
                                "render": function (data, type, row, meta) {
                                    data = '<input type=\"textbox\" name=\"txtMaterialDescriptions' + row.EntryID + '\" class=\"form-control\" id=\"txtMaterialDescriptions' + row.EntryID + '\" style=\"width:180px;text-transform:uppercase\"    value="' + data + '">';
                                    return data;

                                }
                            },
                            {
                                "data": "Containerno",
                                "render": function (data, type, row, meta) {


                                    data = '<a   href="#" class="btn btn-sm btn-primary" title="View" onclick="CopySameContainerNo(\'' + row.EntryID.replace(/'/g, "\\'") + '\')">Copy</a>';


                                    return data;
                                }


                            },


                        ]
                    });

                var table = document.getElementById("example1");
                var row;


                var TotTEUS1 = 0;
                var TotTEUS2 = 0;
                var TotTEUS3 = 0;
                var TotTEUS = 0;

                for (var i = 1; i < table.rows.length; i++) {
                    row = table.rows[i];
                    //var Size = row.cells[6].childNodes[1].value;
                    var Size = row.cells[3].innerText;

                    //alert(Size)

                    if (Size == 20) {
                        TotTEUS1 = Number(TotTEUS1) + 1;
                    }
                    if (Size == 40) {
                        TotTEUS2 = Number(TotTEUS2) + 1;
                    }
                    if (Size == 45) {
                        TotTEUS3 = Number(TotTEUS3) + 1;
                    }
                    //TotTEUS = Number(TotTEUS) + Number(size);


                }
                TotTEUS = TotTEUS1 + (TotTEUS2 * 2) + (TotTEUS3 * 2)
                // alert(TotTEUS);
                $("#lbltwenty").text(TotTEUS1);
                $("#lblforty").text(TotTEUS2);
                $("#lblfortyfive").text(TotTEUS3);
                $("#lblTotal").text(TotTEUS);


            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });
    }

    function checkItemcount() {

        var table = $('#example1').DataTable();

        if (table.rows().count() == 0) {

            return false;
        }
        return true;

    }




    function CopySameContainerNo(Containerno1) {



        var checkboxarray = [];
        $('input[type=checkbox]').each(function () {
            if (this.checked) {

                checkboxarray.push($(this).val());
            }
        });

        var tablearray = [];
        var table = document.getElementById("example1");
        var row;
        for (var i = 1; i < table.rows.length; i++) {

            row = table.rows[i];

            //for (var k = 0; k < checkboxarray.length; k++) {


            //    var InvoiceNo = row.cells[2].innerText;

            //    if (InvoiceNo == Containerno1) {


                    row = table.rows[i];
                    JONo = row.cells[1].innerText;
                    Containerno = row.cells[2].innerText;
                    Size = row.cells[3].innerText;
                    DeliveryType = row.cells[4].innerText;
                    IGMQty = row.cells[5].innerText;
                    Weight = row.cells[6].innerText;
                    Unit = row.cells[7].innerText;
                    DestuffQty = row.cells[8].childNodes[0].value;
            ShortQty = row.cells[9].childNodes[0].value;
            Examine = row.cells[10].childNodes[0].value;

                    EntryID = row.cells[11].innerText;
                    EquipmentID = $("#Equipment" + EntryID + " option:selected").val();
                    Remarks = $("#textRemarks" + EntryID + "").val();
                    Hours = $("#textHours" + EntryID + "").val();
                     CGM = $("#textCGM" + EntryID + "").val();
                     VehicleNo = $("#textVehicleNo" + EntryID + "").val();
                    tablearray.push({
                        'JONo': JONo, 'Containerno': Containerno, 'Size': Size, 'DeliveryType': DeliveryType, 'IGMQty': IGMQty,
                        'DestuffQty': DestuffQty, 'Weight': Weight, 'Examine': Examine, 'Unit': Unit, 'ShortQty': ShortQty, 'EntryID': EntryID,
                        'EquipmentID': EquipmentID, 'Remarks': Remarks, 'Hours': Hours, 'CGM': CGM, 'VehicleNo': VehicleNo
                    })







            //    }
            //}
        }


        var data1 = {
            'Containerdetails': tablearray, 'Containerno1': Containerno1
        };
        var data = JSON.stringify(data1);


        $.ajax({
            url: "/exportModel/WorkOrderTEmpSave",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {



                $('#example1').dataTable({
                    "destroy": true,
                    "bLengthChange": false,
                    "bPaginate": false,
                    //"bFilter": false,
                    "paging": false,
                    "order": false,
                    "aaData": data.List2,
                    "columns": [
                        {

                            "data": "Select",
                            "render": function (data, type, row, meta) {

                                data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\"  checked value="' + row.EntryID + '">';
                                return data;

                            }
                        },
                        { "data": "JONo" },
                        { "data": "Containerno" },
                        { "data": "Size" },
                        { "data": "DeliveryType" },
                        { "data": "IGMQty" },
                        { "data": "Weight" },
                        { "data": "Unit" },
                        {

                            "data": "DestuffQty",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"TxtDestuff' + row.EntryID + '\" class=\"form-control\" id=\"TxtDestuff' + row.EntryID + '\" onchange=\" ChkAmtValidate(this)\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "ShortQty",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"TxtShortQty' + row.EntryID + '\" class=\"form-control\" id=\"TxtShortQty' + row.EntryID + '\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "Examine",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textExamine' + row.EntryID + '\" class=\"form-control\" id=\"textExamine' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        { "data": "EntryID" },


                        {
                            "data": "Equipment",
                            "render": function (data, type, row, meta) {

                                data = '<select  class="form-control" id="Equipment' + row.EntryID + '"  style="width:100px">'
                                for (j = 0; j < EquipmentL.length; j++) {

                                    data += '<option value="' + EquipmentL[j].Id + '"> ' + EquipmentL[j].Equipment + '</option>'

                                }

                                data += '</select>';
                                return data;

                            }

                        },
                        {

                            "data": "Remarks",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textRemarks' + row.EntryID + '\" class=\"form-control\" id=\"textRemarks' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "Hours",
                            "render": function (data, type, row, meta) {888
                                data = '<input type=\"textbox\" name=\"textHours' + row.EntryID + '\" class=\"form-control\" id=\"textHours' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },

                        {

                            "data": "CGM",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textCGM' + row.EntryID + '\" class=\"form-control\" id=\"textCGM' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "VehicleNo",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textVehicleNo' + row.EntryID + '\" class=\"form-control\" id=\"textVehicleNo' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "MaterialQty",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"txtMaterialQty' + row.EntryID + '\" class=\"form-control\" id=\"txtMaterialQty' + row.SRNO + '\" style=\"width:100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "MaterialDescriptions",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"txtMaterialDescriptions' + row.EntryID + '\" class=\"form-control\" id=\"txtMaterialDescriptions' + row.SRNO + '\" style=\"width:180px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {
                            "data": "Containerno",
                            "render": function (data, type, row, meta) {


                                data = '<a   href="#" class="btn btn-sm btn-primary" title="View" onclick="CopySameContainerNo(\'' + row.EntryID.replace(/'/g, "\\'") + '\')">Copy</a>';


                                return data;
                            }


                        },


                    ]
                });




                clearTemptable();


            },

            error: function (error) {
                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);

            }
        });
    }


    function clearTemptable() {

        $.ajax({
            url: "/exportModel/ClearTempWorkorder",

            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
            },

            error: function (error) {
                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);

            }
        });
    }

</script>
<script>
    function Save() {


        var DestuffDate = $("#TxtDestuffDate").val();
        var Category = $("#ddlCategory").val();
        var WOType = $("#ddlWOType").val();
        var CHAID = $("#lblCHAID").val();
        var Vendorname = $("#ddlvendorname").val();
        var Surveyor = $("#ddlSurveyor").val();
        var NocNo = $("#lblNocNo").val();
        var DoValidate = $("#txtDoValidate").val();
        
        if (WOType == 0) {
            document.getElementById('ddlWOType').style.borderColor = "red"
            alert('Work order type cannot be left blank')
            event.preventDefault();
            return;
        }

        if (Vendorname == 0) {
            document.getElementById('ddlvendorname').style.borderColor = "red"
            alert('Vendor name cannot be left blank')
            event.preventDefault();
            return;
        }
        if (CHAID == 0 || CHAID == "") {
            document.getElementById('lblCHAID').style.borderColor = "red"
            alert('Cha name cannot be left blank')
            event.preventDefault();
            return;
        }



        var itemcount = checkItemcount();
        if (itemcount == false) {
            alert("Please enter atleast one destuff entry before saving.");
        }
        else {
            var checkboxarray = [];
            $('input[type=checkbox]').each(function () {
                if (this.checked) {

                    checkboxarray.push($(this).val());
                }
            });

            var tablearray = [];
            var table = document.getElementById("example1");
            var row;
            for (var i = 1; i < table.rows.length; i++) {

                row = table.rows[i];

                for (var k = 0; k < checkboxarray.length; k++) {


                    var InvoiceNo = row.cells[11].innerText;

                    if (InvoiceNo == checkboxarray[k]) {


                        row = table.rows[i];


                        JONo = row.cells[1].innerText;
                        Containerno = row.cells[2].innerText;
                        Size = row.cells[3].innerText;
                        IGMQty = row.cells[5].innerText;
                        igmWeight = row.cells[6].innerText;

                        Unit = row.cells[7].innerText;
                        DestuffQty = row.cells[8].childNodes[0].value;
                        Weight = row.cells[9].childNodes[0].value;
                        Examine = row.cells[10].childNodes[0].value;
                        EntryID = row.cells[11].innerText;
                        Equipment = $("#Equipment" + EntryID + " option:selected").val();
                        Remarks = $("#textRemarks" + EntryID + "").val();
                        Hours = $("#textHours" + EntryID + "").val();
                        CGM = $("#textCGM" + EntryID + "").val();
                        VehicleNo = $("#textVehicleNo" + EntryID + "").val();
                        MaterialQty = $("#txtMaterialQty" + EntryID + "").val();
                        MaterialDescriptions = $("#txtMaterialDescriptions" + EntryID + "").val();


                        tablearray.push({
                            'JONo': JONo, 'Containerno': Containerno, 'Size': Size,
                            'DestuffQty': DestuffQty, 'Weight': Weight, 'Examine': Examine,
                            'Equipment': Equipment, 'Remarks': Remarks, 'Hours': Hours, 'CGM': CGM, 'VehicleNo': VehicleNo, 'IGMQty': IGMQty, 'igmWeight': igmWeight,
                            'MaterialQty': MaterialQty, 'MaterialDescriptions': MaterialDescriptions, 'Unit': Unit
                        })


                    }
                }
            }
        }


            var data1 = {
                'Containerdetails': tablearray, 'DestuffDate': DestuffDate, 'Category': Category, 'WOType': WOType, 'CHAID': CHAID,
                'Vendorname': Vendorname, 'Surveyor': Surveyor, 'NocNo': NocNo, 'DoValidate': DoValidate
            };
            var data = JSON.stringify(data1);


            $.ajax({
                url: "/exportModel/WorkOrderSave",
                data: data,
                type: "POST",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    var array = data.split(',');
                    var b = array[0];
                    var c = (array[1]).trim();
                    var d = (array[2]).trim();
   


                  

                    if (b == "1") {
                        alert("Record saved successfully");
                        Print(c, d)
                            Clear();
                        }
                        else {
                            alert("Record not saved successfully. Try Again!");
                        }
                },

                error: function (error) {
                    let str = error.responseText;
                    var a = str.indexOf("<title>") + 7;
                    var b = str.indexOf("</title>");
                    str = str.substring(a, b);
                    alert("Something went wrong: " + str);

                    $("#tracker-loader").fadeOut("slow");
                }
            });

    }


    function Clear() {
        document.location = '@Url.Action("ImportWorkOrder", "exportModel")';
    }


</script>
<script>
function ChkAmtValidate(id) {
    debugger;
        var WOType = $("#ddlWOType option:selected").text();
        var table = document.getElementById("example1");



        for (var i = 1; i < table.rows.length; i++) {

            row = table.rows[i];
            var Jono = row.cells[1].innerHTML;
            var Containerno = row.cells[2].innerHTML;
            var IGmqty = row.cells[5].innerHTML;
            var Weight = row.cells[6].innerHTML;
            var destuff = row.cells[8].childNodes[0].value;
            var Shortqty = row.cells[9].childNodes[0].value;


            if (destuff != 0) {



                    var intvalue = Math.round(parseInt(Weight) / parseInt(IGmqty) * parseInt(destuff));

                    row.cells[9].childNodes[0].value = intvalue;


            }

                if (destuff != 0) {
                    if (IGmqty >= destuff) {

                        var intvalue11 = Math.round(parseInt(destuff) / parseInt(IGmqty) * 100);

                        row.cells[10].childNodes[0].value = intvalue11;
                    }
                    else
                    {


                        row.cells[10].childNodes[0].value = 0;
                    }
                }


        }

    }</script>

<script>
    function Print(WO_NO, Workyear) {
        debugger;
        var data1 = { 'GPNo': WO_NO, 'Workyear': Workyear };
        var data = JSON.stringify(data1);
        $.ajax({
            url: "/exportModel/Printworkorder",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            // dataType: "json",
            success: function (response) {

                var myWindow = window.open("", "MsgWindow1");
                myWindow.close();
                var myWindow = window.open("", "MsgWindow1");
                myWindow.document.write(response);
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }
    function PrintLoadedexportModelpass(WoNo) {

        var data1 = { 'GPNo': WoNo };
        var data = JSON.stringify(data1);
        $.ajax({
            url: "/exportModel/Printworkorder",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            // dataType: "json",
            success: function (response) {

                var myWindow = window.open("", "MsgWindow1");
                myWindow.close();
                var myWindow = window.open("", "MsgWindow1");
                myWindow.document.write(response);
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }

    function Printsurveyor(WO_NO) {
        debugger;
        var data1 = { 'WoNO': WO_NO };
        var data = JSON.stringify(data1);
        $.ajax({
            url: "/exportModel/Printsurveyor",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            // dataType: "json",
            success: function (response) {

                var myWindow = window.open("", "MsgWindow1");
                myWindow.close();
                var myWindow = window.open("", "MsgWindow1");
                myWindow.document.write(response);
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }


    function ViewSummaryVehicle() {
        $("#diventrytable").hide();
        $("#divviewdetails").show();

        $("#DivIGM1").show();
        $("#divItemNo1").show();
        $("#ddlSearchOnsummary").val('IGM-Item No');
        ViewSummary();
    }
    function getBack() {
        $("#diventrytable").show();
        $("#divviewdetails").hide();
    }


    function ViewSummary() {

        var certeria = $("#ddlSearchOnsummary").val();
        var igmno = $("#TxtIgmnoView").val();
        var itemno = $("#TxtItemNoView").val();
        var Container = $("#txtContainer").val();

        var data1 = { 'certeria': certeria, 'igmno': igmno, 'itemno': itemno, 'Container': Container };
        var data = JSON.stringify(data1);

        $.ajax({
            type: "POST",
            url: "/exportModel/GetWorkorder",
            data: data,
            contentType: "application/json; charset=utf-8",
            success: function (data) {


                $("#TblViewSummarydetails").empty();
                RepTableDataJsonwopaging($("#TblViewSummarydetails"), data, "Voucher Details", "VoucherDetails_List");


            },

            error: function (error) {

                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);

            }
            //})
        })

    }


    //function CloseWO(WONo, SrNo) {
    //    debugger;
    //    var splData = WONo.split('~');
    //    var WorkNo = splData[0];


    //    var data1 = { 'WONo': WorkNo, 'SequenceNo': SrNo };
    //    var data = JSON.stringify(data1);
    //    $.ajax({
    //        url: "/ImportWorkOrder/CloseWorkOrder",
    //        data: data,
    //        type: "POST",
    //        contentType: "application/json; charset=utf-8",
    //        dataType: "json",
    //        success: function (data) {
    //            ViewSummary()
    //            alert(data);

    //        },
    //        failure: function (response) {
    //            alert(response);
    //            alert(response.responseText);
    //        },
    //        error: function (response) {
    //            alert(response.responseText);
    //        }
    //    })
    //}


    function CloseWO(WONo) {
        debugger;
        var splData = WONo.split('~');
        var WorkNo = splData[0];
        var SequenceNo = splData[1];

        var data1 = { 'WONo': WorkNo, 'SequenceNo': SequenceNo };
        var data = JSON.stringify(data1);
        $.ajax({
            url: "/ImportWorkOrder/CloseWorkOrder",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                
                alert(data);
                ViewSummary();
            },
            failure: function (response) {
                alert(response);
                alert(response.responseText);
            },
            error: function (response) {
                alert(response.responseText);
            }
        })
    }
    function CancelFClDetails(EntryID) {
        var data1 = { 'EntryID': EntryID };
        var data = JSON.stringify(data1);
        $.ajax({
            url: "/exportModel/CancelFinalOutConformation",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
             dataType: "json",
            success: function (response) {
                alert("Record cancel successfully!");
                Getspsummary();

            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }


    function showdetailsgrid(WorkNo) {


        var data1 = { 'WONo': WorkNo };
        var data = JSON.stringify(data1);

        $.ajax({
            type: 'POST',
            url: '/exportModel/EditWorkDetailsGrid',
            data: data,
            // data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function (data) {

                $('#example1').dataTable({
                    "destroy": true,
                    "bLengthChange": false,
                    "bPaginate": false,
                    //"bFilter": false,
                    "paging": false,
                    "order": false,
                    "aaData": data,
                    "columns": [
                        {

                            "data": "Select",
                            "render": function (data, type, row, meta) {

                                data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\"  checked value="' + row.EntryID + '">';
                                return data;

                            }
                        },
                        { "data": "JONo" },
                        { "data": "Containerno" },
                        { "data": "Size" },
                        { "data": "DeliveryType" },
                        { "data": "IGMQty" },
                        { "data": "Weight" },
                        { "data": "Unit" },
                        {

                            "data": "DestuffQty",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"TxtDestuff' + row.EntryID + '\" class=\"form-control\" id=\"TxtDestuff' + row.EntryID + '\" onchange=\" ChkAmtValidate(this)\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "WeightS",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"TxtShortQty' + row.EntryID + '\" class=\"form-control\" id=\"TxtShortQty' + row.EntryID + '\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "Examine",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textExamine' + row.EntryID + '\" class=\"form-control\" id=\"textExamine' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },

                        { "data": "EntryID" },


                        {
                            "data": "Equipment",
                            "render": function (data, type, row, meta) {

                                data = '<select  class="form-control" id="Equipment' + row.EntryID + '"  style="width:100px">'
                                for (j = 0; j < EquipmentL.length; j++) {

                                    data += '<option value="' + EquipmentL[j].Id + '"> ' + EquipmentL[j].Equipment + '</option>'

                                }

                                data += '</select>';
                                return data;

                            }

                        },
                        {

                            "data": "Remarks",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textRemarks' + row.EntryID + '\" class=\"form-control\" id=\"textRemarks' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "Hours",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textHours' + row.EntryID + '\" class=\"form-control\" id=\"textHours' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },

                        {

                            "data": "CGM",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textCGM' + row.EntryID + '\" class=\"form-control\" id=\"textCGM' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "VehicleNo",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textVehicleNo' + row.EntryID + '\" class=\"form-control\" id=\"textVehicleNo' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "MaterialQty",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"txtMaterialQty' + row.EntryID + '\" class=\"form-control\" id=\"txtMaterialQty' + row.EntryID + '\" style=\"width:100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "MaterialDescriptions",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"txtMaterialDescriptions' + row.EntryID + '\" class=\"form-control\" id=\"txtMaterialDescriptions' + row.EntryID + '\" style=\"width:180px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {
                            "data": "Containerno",
                            "render": function (data, type, row, meta) {


                                data = '<a   href="#" class="btn btn-sm btn-primary" title="View" onclick="CopySameContainerNo1(\'' + row.EntryID.replace(/'/g, "\\'") + '\')">Copy</a>';


                                return data;
                            }


                        },


                    ]
                });

                var table = document.getElementById("example1");
                var row;


                var TotTEUS1 = 0;
                var TotTEUS2 = 0;
                var TotTEUS3 = 0;
                var TotTEUS = 0;

                for (var i = 1; i < table.rows.length; i++) {
                    row = table.rows[i];
                    //var Size = row.cells[6].childNodes[1].value;
                    var Size = row.cells[3].innerText;

                    //alert(Size)

                    if (Size == 20) {
                        TotTEUS1 = Number(TotTEUS1) + 1;
                    }
                    if (Size == 40) {
                        TotTEUS2 = Number(TotTEUS2) + 1;
                    }
                    if (Size == 45) {
                        TotTEUS3 = Number(TotTEUS3) + 1;
                    }
                    //TotTEUS = Number(TotTEUS) + Number(size);


                }
                TotTEUS = TotTEUS1 + (TotTEUS2 * 2) + (TotTEUS3 * 2)
                // alert(TotTEUS);
                $("#lbltwenty").text(TotTEUS1);
                $("#lblforty").text(TotTEUS2);
                $("#lblfortyfive").text(TotTEUS3);
                $("#lblTotal").text(TotTEUS);


            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });
    }



    function CopySameContainerNo1(Containerno1) {



        var checkboxarray = [];
        $('input[type=checkbox]').each(function () {
            if (this.checked) {

                checkboxarray.push($(this).val());
            }
        });

        var tablearray = [];
        var table = document.getElementById("example1");
        var row;
        for (var i = 1; i < table.rows.length; i++) {

            row = table.rows[i];

            //for (var k = 0; k < checkboxarray.length; k++) {


            //    var InvoiceNo = row.cells[11].innerText;

            //    if (InvoiceNo == Containerno1) {


            row = table.rows[i];
            JONo = row.cells[1].innerText;
            Containerno = row.cells[2].innerText;
            Size = row.cells[3].innerText;
            DeliveryType = row.cells[4].innerText;
            IGMQty = row.cells[5].innerText;
            Weight = row.cells[6].innerText;
            Unit = row.cells[7].innerText;
            DestuffQty = row.cells[8].childNodes[0].value;
            ShortQty = row.cells[9].childNodes[0].value;
            Examine = row.cells[10].childNodes[0].value;
            EntryID = row.cells[11].innerText;
            EquipmentID = $("#Equipment" + EntryID + " option:selected").val();
            Remarks = $("#textRemarks" + EntryID + "").val();
            Hours = $("#textHours" + EntryID + "").val();
            CGM = $("#textCGM" + EntryID + "").val();
            VehicleNo = $("#textVehicleNo" + EntryID + "").val();
            tablearray.push({
                'JONo': JONo, 'Containerno': Containerno, 'Size': Size, 'DeliveryType': DeliveryType, 'IGMQty': IGMQty,
                'DestuffQty': DestuffQty, 'Weight': Weight, 'Examine': Examine, 'Unit': Unit, 'ShortQty': ShortQty, 'EntryID': EntryID,
                'EquipmentID': EquipmentID, 'Remarks': Remarks, 'Hours': Hours, 'CGM': CGM, 'VehicleNo': VehicleNo
            })
            //    }
            //}
        }


        var data1 = {
            'Containerdetails': tablearray, 'Containerno1': Containerno1
        };
        var data = JSON.stringify(data1);


        $.ajax({
            url: "/exportModel/WorkOrderTEmpSave",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {



                $('#example1').dataTable({
                    "destroy": true,
                    "bLengthChange": false,
                    "bPaginate": false,
                    //"bFilter": false,
                    "paging": false,
                    "order": false,
                    "aaData": data.List2,
                    "columns": [
                        {

                            "data": "Select",
                            "render": function (data, type, row, meta) {

                                data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\"  checked value="' + row.EntryID + '">';
                                return data;

                            }
                        },
                        { "data": "JONo" },
                        { "data": "Containerno" },
                        { "data": "Size" },
                        { "data": "DeliveryType" },
                        { "data": "IGMQty" },
                        { "data": "Weight" },
                        { "data": "Unit" },
                        {

                            "data": "DestuffQty",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"TxtDestuff' + row.EntryID + '\" class=\"form-control\" id=\"TxtDestuff' + row.EntryID + '\" onchange=\" ChkAmtValidate(this)\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "ShortQty",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"TxtShortQty' + row.EntryID + '\" class=\"form-control\" id=\"TxtShortQty' + row.EntryID + '\" style=\"width: 100px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "Examine",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textExamine' + row.EntryID + '\" class=\"form-control\" id=\"textExamine' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },

                        { "data": "EntryID" },


                        {
                            "data": "Equipment",
                            "render": function (data, type, row, meta) {

                                data = '<select  class="form-control" id="Equipment' + row.EntryID + '"  style="width:100px">'
                                for (j = 0; j < EquipmentL.length; j++) {

                                    data += '<option value="' + EquipmentL[j].Id + '"> ' + EquipmentL[j].Equipment + '</option>'

                                }

                                data += '</select>';
                                return data;

                            }

                        },
                        {

                            "data": "Remarks",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textRemarks' + row.EntryID + '\" class=\"form-control\" id=\"textRemarks' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "Hours",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textHours' + row.EntryID + '\" class=\"form-control\" id=\"textHours' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },

                        {

                            "data": "CGM",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textCGM' + row.EntryID + '\" class=\"form-control\" id=\"textCGM' + row.EntryID + '\" style=\"width:80px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },
                        {

                            "data": "VehicleNo",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"textbox\" name=\"textVehicleNo' + row.EntryID + '\" class=\"form-control\" id=\"textVehicleNo' + row.EntryID + '\" style=\"width:200px;text-transform:uppercase\"    value="' + data + '">';
                                return data;

                            }
                        },

                        {
                            "data": "Containerno",
                            "render": function (data, type, row, meta) {


                                data = '<a   href="#" class="btn btn-sm btn-primary" title="View" onclick="CopySameContainerNo(\'' + row.EntryID.replace(/'/g, "\\'") + '\')">Copy</a>';


                                return data;
                            }


                        },


                    ]
                });




                clearTemptable();


            },

            error: function (error) {
                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);

            }
        });
    }

    function editclosed() {
        debugger;
        $("#tracker-loader").fadeIn("slow");
        var DestuffDate = $("#TxtDestuffDate").val();
        var Category = $("#ddlCategory").val();
        var WOType = $("#ddlWOType").val();
        var CHAID = $("#lblCHAID").val();
        var Vendorname = $("#ddlvendorname").val();
        var WoNo = $("#TXtEntryid").val();


        var itemcount = checkItemcount();
        if (itemcount == false) {
            alert("Please enter atleast one destuff entry before saving.");
        }
        else {
            var checkboxarray = [];
            $('input[type=checkbox]').each(function () {
                if (this.checked) {

                    checkboxarray.push($(this).val());
                }
            });

            var tablearray = [];
            var table = document.getElementById("example1");
            var row;
            for (var i = 1; i < table.rows.length; i++) {

                row = table.rows[i];

                for (var k = 0; k < checkboxarray.length; k++) {


                    var InvoiceNo = row.cells[11].innerText;

                    if (InvoiceNo == checkboxarray[k]) {


                        row = table.rows[i];
                        JONo = row.cells[1].innerText;
                        Containerno = row.cells[2].innerText;
                        Size = row.cells[3].innerText;
                        DestuffQty =    row.cells[8].childNodes[0].value;
                        Weight = row.cells[9].childNodes[0].value;
                        Examine = row.cells[10].childNodes[0].value;
                        EntryID = row.cells[11].innerText;
                        Equipment = $("#Equipment" + EntryID + " option:selected").val();
                        Remarks = $("#textRemarks" + EntryID + "").val();
                        Hours = $("#textHours" + EntryID + "").val();
                        CGM = $("#textCGM" + EntryID + "").val();
                        VehicleNo = $("#textVehicleNo" + EntryID + "").val();


                        if (WOType == "Cargo Loading" && VehicleNo == "") {
                            alert("Vehicle No cannot be blank!");

                            $("#tracker-loader").fadeOut("slow");
                            return false;
                        }
                        MaterialQty = $("#txtMaterialQty" + EntryID + "").val();
                        MaterialDescriptions = $("#txtMaterialDescriptions" + EntryID + "").val();


                        tablearray.push({
                            'JONo': JONo, 'Containerno': Containerno, 'Size': Size,
                            'DestuffQty': DestuffQty, 'Weight': Weight, 'Examine': Examine,
                            'Equipment': Equipment, 'Remarks': Remarks, 'Hours': Hours, 'CGM': CGM, 'VehicleNo': VehicleNo, 'EntryID': EntryID, 'MaterialQty': MaterialQty, 'MaterialDescriptions': MaterialDescriptions
                        })


                    }
                }
            }
        }


        var data1 = {
            'Containerdetails': tablearray, 'DestuffDate': DestuffDate, 'Category': Category, 'WOType': WOType, 'CHAID': CHAID, 'Vendorname': Vendorname, 'WoNo': WoNo
        };
        var data = JSON.stringify(data1);


        $.ajax({
            url: "/exportModel/WorkOrderUpdate",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                alert(data);


                document.location = '@Url.Action("ImportWorkOrder", "exportModel")';
                $("#tracker-loader").fadeOut("slow");

            },

            error: function (error) {
                let str = error.responseText;
                var a = str.indexOf("<title>") + 7;
                var b = str.indexOf("</title>");
                str = str.substring(a, b);
                alert("Something went wrong: " + str);

                $("#tracker-loader").fadeOut("slow");
            }
        });

    }

</script>

<script>

    $(document).ready(function () {
        AutomCom();

    });
    function AutomCom() {
        $("#txtCHA").autocomplete({

            source: function (request, response) {

                $.ajax({
                    url: "/ExportSBEntries/getPartyNameCHA",
                    data: "{ 'prefixText': '" + request.term + "'}",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {

                        response($.map(data, function (item) {

                            return {
                                label: item.CHAName,
                                val: item.CHAID
                            };
                        }))
                    },
                    error: function (response) {
                        alert(response.responseText);
                    },
                    failure: function (response) {
                        alert(response.responseText);
                    }
                })
            },
            select: function (e, i) {
                //
                $("#txtCHA").val(i.item.label);
                $("#lblCHAID").val(i.item.val);
            },
            minLength: 1
        });
    };



    $("#flowcheckall").click(function () {

        var oTableStaticFlow = $('#example1').DataTable();


        var cells = oTableStaticFlow.column(0).nodes(), // Cells from 1st column
            state = this.checked;

        for (var i = 0; i < cells.length; i += 1) {
            cells[i].querySelector("input[type='checkbox']").checked = state;
        }
    });



    function CancelWo(WO_NO) {
          var data1 = {
              'WO_NO': WO_NO
        };
        var data = JSON.stringify(data1);


        if (confirm('Are you sure you want to cancel this wo_no "' + WO_NO+'"')) {

            $.ajax({
                url: "/exportModel/CancelImportworkOrder",
                data: data,
                type: "POST",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    data = JSON.parse(data);
                    alert(data[0].mgs);
                    ViewSummary();


                },

                error: function (error) {
                    let str = error.responseText;
                    var a = str.indexOf("<title>") + 7;
                    var b = str.indexOf("</title>");
                    str = str.substring(a, b);
                    alert("Something went wrong: " + str);

                    $("#tracker-loader").fadeOut("slow");
                }
            });
        } else {
            alert("you pressed Cancel");
        }






    }</script>