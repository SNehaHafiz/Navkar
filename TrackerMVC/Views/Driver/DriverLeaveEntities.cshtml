
@{
    ViewBag.Title = "Driver Leave Entities";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}

<script src="~/js/GetTableJsonwopaging.js"></script>
<div id="tracker-loader"></div>
<div class="content-area overflow-hidden" id="divDriver">
    <div>
    <div class="page-header">
        <h4 class="page-title">Driver Leave Entry</h4>
        <div class="form-group">
            <label class="form-label"></label>
            <div class="row gutters-xs">
                <div class="col">
                    <button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="ViewSummary();"><i class="fa fa-file-text"></i></button>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body p-6">
                      
                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Trailer No(Last 4 digits)</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("txtTrailerno", null, new { @class = "form-control", @id = "Trailerno", name = "Trailerno", autocomplete = "off", placeholder = "Trailer No", @maxlength = 4 })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12" id="divtrailernodrop">
                                <label class="form-label">Trailer No </label>
                                <select id="ddlTrailerNo" class="form-control">
                                    <option value="">--Select--</option>
                                </select>
                            </div>
                        </div>
                       
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Driver Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtDriverName", null, new { @class = "form-control", @id = "TxtDriverName", @name = "TxtDriverName", autocomplete = "off",@readonly = true })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">License Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtLieneceName", null, new { @class = "form-control", @id = "TxtLieneceName", @name = "TxtLieneceName", autocomplete = "off", @readonly = true })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Aadhar Card No.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtAadharcardno", null, new { @class = "form-control", @id = "TxtAadharcardno", @name = "TxtAadharcardno", autocomplete = "off", @readonly = true })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Pan Card No.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtPancardNo", null, new { @class = "form-control", @id = "TxtPancardNo", @name = "TxtPancardNo", autocomplete = "off", @readonly = true })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Trailer Size</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TXtSize", null, new { @class = "form-control", @id = "TXtSize", @name = "TXtSize", autocomplete = "off", @readonly = true })

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Model No.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtModelNo", null, new { @class = "form-control", @id = "TxtModelNo", @name = "TxtModelNo", autocomplete = "off", @readonly = true })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Leave For Days</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlDriverleave", (IEnumerable<SelectListItem>)ViewBag.LeaveList, "--Select-- ", new { @class = "form-control", @id = "ddlDriverleave", name = "ddlDriverleave", autocomplete = "off" })

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Remarks</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtRemarks", null, new { @class = "form-control", @id = "TxtRemarks", @name = "TxtRemarks", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-1 col-xs-4">
                            <div class="form-group">
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <button class="btn btn-success btn-xs" id="btnSaveDriver" onclick="SaveDriverdetails();">Save</button>
                                        <input  id="driverid" type="text" style="visibility:hidden"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    </div>
</div>



s
<div class=" content-area" id="divSummary" style="display:none">
    <div class="page-header">
        <h4 class="page-title">Driver Leave Summary </h4>
        <div class="ibox-content  text-right">
            <a onclick="getBack();" class="btn btn-primary btn-success" style="color:white;align-content:center;"><i class="fa fa-arrow-left" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Back"></i>  </a></li>
        </div>

    </div>
    @Html.ActionLink("Export To Excel", "ExportToExcelDriverLeaveEntities", null, new { @class = "btn btn-primary btn-md" })

    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover tbl-cart text-nowrap" id="example">
                                <thead>
                                    <tr></tr>
                                </thead>
                            </table>
                        </div>
                    </div>

                </div>


            </div>
        </div>
    </div>
</div>

<script>
    $(window).on("load", function (e) {
        $("#tracker-loader").fadeOut("slow");
    })
</script>

<script>
    $('#Trailerno').change(function (e) {
        var trailerno = $("#Trailerno").val();
       
        $.ajax({
            url: "/ManualPortOut/AjaxGetTrailerNo",
            data: '{trailerno: ' + JSON.stringify(trailerno) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
               
                var select = $("#ddlTrailerNo");

                select.empty();
                select.append($('<option/>', {
                    value: "",
                    text: "--Select--"
                }));

                $.each(data, function (data, value) {

                    select.append($("<option></option>").val(value.trailerid).html(value.trailername));
                })
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });




    });


    $('#ddlTrailerNo').change(function (e) {
        var Trailername = $("#ddlTrailerNo option:selected").val();

        $.ajax({
            url: "/Driver/AddDriverDetails",
            data: '{Trailername: ' + JSON.stringify(Trailername) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                $("#driverid").val(data.DriverID);
                $("#TxtDriverName").val(data.DriverName);
                $("#TxtLieneceName").val(data.LicenceNo);
                $("#TxtAadharcardno").val(data.AdharNumber);
                $("#TxtPancardNo").val(data.Pannumber);
                $("#TXtSize").val(data.TrailerSize);
                $("#TxtModelNo").val(data.TrailerModel);
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });


    });
   



    function SaveDriverdetails() {
        var Driverid = $("#driverid").val();
        var TrailerNo = $("#divtrailernodrop option:selected").val();
        var DriverleaveFor = $("#ddlDriverleave option:selected").val();
        var Remarks = $("#TxtRemarks").val();

        var data1 = {
            'Driverid': Driverid,
            'TrailerNo': TrailerNo, 'DriverleaveFor': DriverleaveFor, 'Remarks': Remarks
        };
        var data = JSON.stringify(data1);
     

        $.ajax({
            url: "/Driver/AddDriverLeaveEntites",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                alert("record saved successfully!")
                document.location = '@Url.Action("DriverLeaveEntities", "Driver")'
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
        
    }
</script>


<script>
    function ViewSummary() {
        $("#divSummary").show();
        $("#divDriver").hide();

        $("#tracker-loader").fadeIn("slow");
        $.ajax({
            type: 'POST',
            url: '/Driver/GetDriverLeaveEntries',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function (jsonResult) {
                $("#example").empty();
                RepTableDataJsonwopaging($("#example"), jsonResult, "Voucher Details", "VoucherDetails_List");
                $("#tracker-loader").fadeOut("slow");
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });
    }


    function getBack() {
        $("#divSummary").hide();
        $("#divDriver").show();
    }
</script>