
@{
    ViewBag.Title = "Generate Lorry Receipt";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}



<div class=" content-area" id="diventry">
    <div class="page-header">
        <h4 class="page-title">Generate Lorry Receipt</h4>
        <div class="form-group">
            <label class="form-label"></label>
            <div class="row gutters-xs">
                <div class="col">

                    <button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="showView();"><i class="fa fa-file-text"></i></button>
                    <br />

                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">

                    <div class="row">
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">LR No</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @*@Html.TextBox("txtissue", null, new { @class = "form-control", @id = "txtissue", name = "txtissue", autocomplete = "off", @maxlength = 500,  @readonly = "Readonly" })*@
                                        @Html.TextBox("TxtLrNo", null, new { @class = "form-control", @readonly = "readonly", @Value = "New" })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">LR Date</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @*@Html.TextBox("txtissue", null, new { @class = "form-control", @id = "txtissue", name = "txtissue", autocomplete = "off", @maxlength = 500,  @readonly = "Readonly" })*@
                                        @Html.TextBox("TxtLrDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy hh:mm"), @readonly = "readonly" })


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Activity</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlactivity", (IEnumerable<SelectListItem>)ViewBag.ActivityMaster, "--Select--", new { @class = "form-control", @id = "ddlactivity", name = "ddlactivity" })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Booking No</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @*@Html.TextBox("txtissue", null, new { @class = "form-control", @id = "txtissue", name = "txtissue", autocomplete = "off", @maxlength = 500,  @readonly = "Readonly" })*@
                                        @Html.TextBox("TxtBookingno", null, new { @class = "form-control", @id = "TxtBookingno" })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Shipping Line</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlshippingline", (IEnumerable<SelectListItem>)ViewBag.ShippingLineList, "--Select--", new { @class = "form-control", @id = "ddlshippingline", name = "ddlshippingline" })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Customer Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlcustomer", (IEnumerable<SelectListItem>)ViewBag.CustomerList, "--Select--", new { @class = "form-control", @id = "ddlcustomer", name = "ddlcustomer" })


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                   
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Container Count</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlcontaiercount", (IEnumerable<SelectListItem>)ViewBag.MovCount, "--Select--", new { @class = "form-control", @id = "ddlcontaiercount", name = "ddlcontaiercount" })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label">From Location</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlfromlocation", (IEnumerable<SelectListItem>)ViewBag.Location, "--Select--", new { @class = "form-control", @id = "ddlfromlocation", name = "ddlfromlocation" })

                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label">To Location</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddltolocation", (IEnumerable<SelectListItem>)ViewBag.Location, "--Select--", new { @class = "form-control", @id = "ddltolocation", name = "ddltolocation" })

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                 
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Container No</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtContainerno", null, new { @class = "form-control", @id = "TxtContainerno", name = "TxtContainerno", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label">Size</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("TxtSize", (IEnumerable<SelectListItem>)ViewBag.MovCount, "--Select--", new { @class = "form-control", @id = "TxtSize", name = "TxtSize" })

                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label">Type</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("TxtType", (IEnumerable<SelectListItem>)ViewBag.MovType, "--Select--", new { @class = "form-control", @id = "TxtType", name = "TxtType" })

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                   
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Trailer No(Last 4 digits)</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtTrailerno", null, new { @class = "form-control", @id = "Trailerno", name = "Trailerno", autocomplete = "off", placeholder = "Trailer No", @maxlength = 4 })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12" id="divtrailernodrop">
                            <label class="form-label">Trailer No </label>
                            <select id="ddlTrailerNo" class="form-control">
                                <option value="">--Select--</option>
                            </select>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label">Transporter</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("TxtTransporter", (IEnumerable<SelectListItem>)ViewBag.Transpoter, "--Select--", new { @class = "form-control", @id = "TxtTransporter", name = "TxtTransporter" })

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                   
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Agent Seal</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtAgentseal", null, new { @class = "form-control", @id = "TxtAgentseal", name = "TxtAgentseal", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">BOE No</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtBoEno", null, new { @class = "form-control", @id = "TxtBoEno", name = "TxtBoEno", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Weight</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtWeight", null, new { @class = "form-control", @id = "TxtWeight", name = "TxtWeight", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Tare Weight</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtWateweight", null, new { @class = "form-control", @id = "TxtWateweight", name = "TxtWateweight", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Stuff Location</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtStuffLocation", null, new { @class = "form-control", @id = "TxtStuffLocation", name = "TxtStuffLocation", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Consignee</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtConsignee", null, new { @class = "form-control", @id = "TxtConsignee", name = "TxtConsignee", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-1 col-lg-1">
                            <label class="form-label" style="visibility:hidden">Save</label>
                            <div class="form-group label-floating">
                                <button class="btn btn-primary " type="button" id="Add" onclick="Addintables()" name="Add">Add</button>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div>
                                <label class="form-label">Details </label>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered" id="example" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th class="wd-15p sorting">Container No.</th>
                                            <th class="sorting">size</th>
                                            <th class="wd-15p sorting">Vehicle No.</th>
                                            <th class="wd-15p sorting">Agent Seal</th>
                                            <th class="wd-15p sorting">booking No</th>
                                            <th class="wd-15p sorting">Activity</th>
                                            <th class="wd-15p sorting">From Location</th>
                                            <th class="wd-15p sorting">To Location</th>
                                         @*  <th class="wd-10p sorting">Entry ID</th>*@
                                            <th class="wd-15p sorting">Boe No</th>
                                            <th class="wd-15p sorting">Weight</th>
                                          <th class="wd-15p sorting">Stuff Location</th>
                                            <th></th>

                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2 col-lg-4">
                            <div class="form-group">
                                <label class="form-label"></label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <input type="submit" id="btnSave" name="save" value="Save" class="btn btn-success" onclick="SaveExpensesDetails()" />
                                        <input type="text" id="Entryid" style="visibility:hidden" />

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- table-wrapper -->
        </div>
        <!-- section-wrapper -->
    </div>
</div>




<script>


    $('#TxtContainerno').change(function (e) {
        var containerno = $("#TxtContainerno").val();
        var Activity = $("#ddlactivity option:selected").text();
        var data1 = { 'containerno': containerno, 'Activity': Activity };
        var data = JSON.stringify(data1);
        $.ajax({
            type: 'POST',
            url: '/LRClosing/AjaxGetEntryid',
            data: data,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function (data) {

                $("#Entryid").text(data);
            }

        });




    });






    var storeAddedItem = [];
        function Addintables() {
            $("#Entryid").text(0);
            var element = {};
            element.Lrdate = $("#TxtLrDate").val();
            element.Bookingno = $("#TxtBookingno").val();
            element.ShippingLine = $("#ddlshippingline option:selected").val();
            element.CustomerName = $("#ddlcustomer option:selected").val();
            element.ContainerCount = $("#ddlcontaiercount option:selected").text();
            element.fromlocation = $("#ddlfromlocation option:selected").text();
            element.tolocation = $("#ddltolocation option:selected").text();
            element.Containerno = $("#TxtContainerno").val();
            element.Containerno = $("#TxtContainerno").val();
            element.size = $("#TxtSize option:selected").text();
            element.type = $("#TxtType option:selected").val();
            element.TrailerNo = $("#divtrailernodrop option:selected").text();
            element.Transporter = $("#TxtTransporter option:selected").val();
            element.Agentseal = $("#TxtAgentseal").val();
            element.BOENo = $("#TxtBoEno").val();
            element.Weight = $("#TxtWeight").val();
            element.Tareweight = $("#TxtWateweight").val();
            element.TxtConsginee = $("#TxtConsignee").val();
            element.Activity = $("#ddlactivity option:selected").text();
            element.StuffLocation = $("#TxtStuffLocation").text();

          
            storeAddedItem.push(element);
            $('#example').DataTable({
                "destroy": true,
                "bLengthChange": false,
                "aaData": storeAddedItem,
                "bPaginate": false,
                "bInfo": false,
                "paging": false,
                "columns": [
                    { "data": "Containerno" },
                    { "data": "size" },
                    { "data": "TrailerNo" },
                    { "data": "Agentseal" },
                    { "data": "Bookingno" },
                    { "data": "Activity" },
                    { "data": "fromlocation" },
                    { "data": "tolocation" },
                    { "data": "BOENo" },
                    { "data": "Weight" },
                    { "data": "StuffLocation" },
                    {
                        "data": "Containerno",
                        "orderable": false,
                        "render": function (data, type, row, meta) {
                            if (type === 'display') {
                                data = "<button type=\"button\" class=\"btn btn-icon btn-primary btn-danger removebutton \" name=\"removebutton\" style=\"height:35px;\" onclick=\"deleteSelecetedItem('" + row.Containerno + "')\"><i class=\"fe fe-trash\" style=\"font-size: 16px;\"></i></button>"
                            }
                            return data;
                        }
                    }
                ]
            });
        }
    
</script>
<script>
    $('#Trailerno').change(function (e) {
        var trailerno = $("#Trailerno").val();
        $.ajax({
            url: "/ManualPortOut/AjaxGetTrailerNo",
            data: '{trailerno: ' + JSON.stringify(trailerno) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {

                var select = $("#ddlTrailerNo");

                select.empty();
                select.append($('<option/>', {
                    value: "",
                    text: "--Select--"
                }));

                $.each(data, function (data, value) {

                    select.append($("<option></option>").val(value.trailerid).html(value.trailername));
                })
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });




    });


    function deleteSelecetedItem(Containerno) {
        for (i = 0; i < storeAddedItem.length; i++) {
            if (this.storeAddedItem[i].Containerno == Containerno) {
                storeAddedItem.splice(i, 1);
            }
        }
        $('#example').DataTable({
            "destroy": true,
            "bLengthChange": false,
            "aaData": storeAddedItem,
            "bPaginate": false,
            "bInfo": false,
            "paging": false,
            "columns": [
                { "data": "Containerno" },
                { "data": "size" },
                { "data": "TrailerNo" },
                { "data": "Agentseal" },
                { "data": "Bookingno" },
                { "data": "Activity" },
                { "data": "fromlocation" },
                { "data": "tolocation" },
                { "data": "BOENo" },
                { "data": "Weight" },
                {
                    "data": "Containerno",
                    "orderable": false,
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = "<button type=\"button\" class=\"btn btn-icon btn-primary btn-danger removebutton \" name=\"removebutton\" style=\"height:35px;\" onclick=\"deleteSelecetedItem('" + row.Containerno + "')\"><i class=\"fe fe-trash\" style=\"font-size: 16px;\"></i></button>"
                        }
                        return data;
                    }
                }
            ]
        });
    }
</script>