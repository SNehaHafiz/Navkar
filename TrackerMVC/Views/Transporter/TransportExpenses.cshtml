
@{
    ViewBag.Title = "Transport Expenses";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}
<style>
    .table thead th, .text-wrap table thead th {
        background-color: #9f78ff;
        color: white;
    }

    table.table-bordered.dataTable tbody th, table.table-bordered.dataTable tbody td {
        color: black;
        font-weight: 900 !important;
        font-size: 15px !important;
    }
</style>
 
<div class=" content-area" id="diventry">
    <div class="page-header">
        <h4 class="page-title">Transport Expenses</h4>
        <div class="form-group">
            <label class="form-label"></label>
            <div class="row gutters-xs">
                <div class="col">

                    <button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="showView();"><i class="fa fa-file-text"></i></button>
                    <br />

                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">

                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Expense Type</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlexpensestype", new List<SelectListItem>
                                            {
                                              new SelectListItem { Text = "Other Expenses", Value = "Other Expenses"},
                                              new SelectListItem { Text = "offloading", Value = "offloading"},
                                          }, new { @class = "form-control", autocomplete = "off" })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Expense Date</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @*@Html.TextBox("txtissue", null, new { @class = "form-control", @id = "txtissue", name = "txtissue", autocomplete = "off", @maxlength = 500,  @readonly = "Readonly" })*@
                                        @Html.TextBox("txtissue", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy hh:mm"), @readonly = "readonly" })


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" id="divoffloading" style="display:none">
                        <div class="col-lg-4 col-sm-12">
                            <label class="form-label">Container No</label>
                            <div class="input-group">

                                <input type="text" class="form-control br-tl-7 br-bl-7 float-right" placeholder="" id="txtoffloadingContainerno">
                                <div class="input-group-append ">
                                    <button type="button" class="btn btn-primary br-tr-7 br-br-7" onclick="ShowVOffloadingoucherNo()">
                                        <i class="fa fa-search" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" id="divotherexpneses">
                        <div class="col-lg-4 col-sm-12 ">
                            <label class="form-label">Container/vehicle No. </label>
                            <div class="input-group">

                                <input type="text" class="form-control br-tl-7 br-bl-7 float-right" placeholder="" id="Containerno">
                                <div class="input-group-append ">
                                    <button type="button" class="btn btn-primary br-tr-7 br-br-7" onclick="ShowVoucherNo()">
                                        <i class="fa fa-search" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div class="table-responsive">
                                <table class="table table-bordered table-hover tbl-cart text-nowrap" id="example1">
                                    <thead>
                                        <tr>

                                            <th class="wd-15p sorting"></th>
                                            <th class="wd-15p sorting">Voucher No.</th>
                                            <th class="wd-15p sorting">Voucher Date</th>
                                            <th class="wd-15p sorting">Trailer No.</th>
                                            <th class="wd-15p sorting">Container No.</th>
                                            <th class="wd-15p sorting">Size</th>
                                            <th class="wd-15p sorting">Driver Name</th>
                                            <th class="wd-15p sorting">From Location</th>
                                            <th class="wd-15p sorting">TO Location</th>
                                            <th class="wd-15p sorting">Activity</th>
                                            <th class="wd-15p sorting">Party</th>
                                            <th class="wd-15p sorting">AutoID</th>
                                        </tr>
                                    </thead>

                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Expenses Head</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlexpensesfor", (IEnumerable<SelectListItem>)ViewBag.ExpensesList, "--Select--", new { @class = "form-control", @id = "ddlexpensesfor", name = "ddlexpensesfor" })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Vendor Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <input type="text" class="form-control" id="ddlvendorName"  />
                                        <input type="hidden" class="form-control" id="hdnExpensesHead" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        @*<div class="col-lg-4 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Vendor Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlvendorName", (IEnumerable<SelectListItem>)ViewBag.VendorLists, "--Select--", new { @class = "form-control", @id = "ddlvendorName", name = "ddlvendorName" })


                                    </div>
                                </div>
                            </div>
                        </div>*@
                        <div class="col-lg-2 col-sm-12" id="divtrailernodrop">
                            <label class="form-label">GST No </label>
                            <select id="ddlGSTNo" class="form-control"></select>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Tax Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlTaxName", (IEnumerable<SelectListItem>)ViewBag.TaxIDs, "--Select--", new { @class = "form-control", @id = "ddlTaxName", name = "ddlTaxName", onchange = "GetGSTDetails()" })


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="display:none" id="divaddexpense">
                        <div class="col-lg-5 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Expense Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtexpense", null, new { @class = "form-control", @id = "txtexpense", name = "txtexpense", autocomplete = "off" })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" style="visibility:hidden">.</label>
                            <div class="row gutters-xs">

                                <div class="col">

                                    <input type="button" id="Add" name="Add" value="Add" onclick="ShowExpenseFor()"   class="btn btn-primary" />
                                    <br />

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Net Amount</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtAmount", null, new { @class = "form-control", @id = "txtAmount", name = "txtAmount", autocomplete = "off", onkeypress = "isValidAmount()", onblur= "Filldetailsintbl()" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">CGST</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtCGSTAmount", null, new { @class = "form-control", @id = "txtCGSTAmount", name = "txtCGSTAmount",  autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">SGST</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtSGSTAmount", null, new { @class = "form-control", @id = "txtSGSTAmount", name = "txtSGSTAmount", autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">IGST</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtIGSTAmount", null, new { @class = "form-control", @id = "txtIGSTAmount", name = "txtIGSTAmount", autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Total Amount</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtGRANDAmount", null, new { @class = "form-control", @id = "txtGRANDAmount", name = "txtGRANDAmount", autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                    <div class="row">
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label">Payment Mode</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlpaymentmode", (IEnumerable<SelectListItem>)ViewBag.PaymentMode, "--Select--", new { @class = "form-control", @id = "ddlpaymentmode", name = "ddlpaymentmode" })



                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Invoice Date</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtInvoiceDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy hh:mm") })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Invoice No</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtInvocieno", null, new { @class = "form-control", @id = "TxtInvocieno", name = "TxtInvocieno", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Remark</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtremark", null, new { @class = "form-control", @id = "txtremark", name = "txtremark", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-1 col-lg-1">
                            <label class="form-label" style="visibility:hidden">Save</label>
                            <div class="form-group label-floating">
                                <button class="btn btn-primary " type="button" id="Add" onclick="SaveExpenses()" name="Add">Add</button>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div>
                                <label class="form-label">Details </label>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered" id="tablexpensehead" style="width:100%">
                                    <thead>
                                        <tr>
                                            @*<th class="wd-15p sorting">Sr No.</th>*@
                                            <th class="wd-15p sorting">Voucher No.</th>
                                            <th class="sorting">Expenses Head</th>
                                            <th class="wd-15p sorting">Trailer No.</th>
                                            <th class="wd-15p sorting">Container No.</th>
                                            <th class="wd-15p sorting">Size</th>
                                            <th class="wd-15p sorting">Activity</th>
                                            <th class="wd-15p sorting">Vendor Name</th>

                                            <th class="wd-10p sorting">Amount</th>
                                            <th class="wd-10p sorting">CGST</th>
                                            <th class="wd-10p sorting">SGST</th>
                                            <th class="wd-10p sorting">IGST</th>
                                            <th class="wd-10p sorting">Grand Total</th>
                                            <th class="wd-15p sorting">Remarks</th>
                                            <th class="wd-15p sorting">Auto ID</th>
                                            <th class="wd-15p sorting">PaymentMode</th>
                                            <th class="wd-15p sorting">Tax ID</th>
                                            <th class="wd-15p sorting">Vendor ID</th>
                                            <th></th>

                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2 col-lg-4">
                            <div class="form-group">
                                <label class="form-label"></label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <input type="submit" id="btnSave" name="save" value="Save" class="btn btn-success" onclick="SaveExpensesDetails()" />
                                        <input type="text" id="driverid" style="visibility:hidden" />

                                        <input type="hidden" id="TxtSgstGet" />
                                        <input type="hidden" id="CGSTGet" />
                                        <input type="hidden" id="IGSTGet" />

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- table-wrapper -->
        </div>
        <!-- section-wrapper -->
    </div>
</div>

<div class=" content-area" id="divView" style="display:none">
    <div class="page-header">
        <h4 class="page-title">Transport Expenses Summary</h4>
        <div class="ibox-content  text-right">
            <a onclick="getBack();" class="btn btn-primary btn-success" style="color:white;align-content:center;"><i class="fa fa-arrow-left" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Back"></i>  </a></li>
        </div>

    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="form-horizontal">
                        <div class="row">
                            <div class="row">
                                <div class="col-lg-5 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label">From Date</label>
                                        <div class="row gutters-xs">
                                            <div class="col">
                                                @Html.TextBox("FromDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.AddDays(-1).ToString("dd MMM yyyy 08:00") })

                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-5 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label"> To Date</label>
                                        <div class="row gutters-xs">
                                            <div class="col">
                                                @Html.TextBox("ToDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy 07:59") })

                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-1 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label" style="visibility:hidden">.</label>
                                        <div class="row gutters-xs">
                                            <div class="col">
                                                <input type="button" id="btnShow" value="Show" class="btn btn-primary " onclick="ShowExpenseSummary()" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    @Html.ActionLink("Export To Excel", "ExportToExcelexpence", null, new { @class = "btn btn-primary btn-md" })

                    <div class="row">
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover tbl-cart text-nowrap" id="example">
                                <thead>
                                    <tr>
                                        <th>Upload</th>
                                        <th>View</th>
                                        <th>Edit</th>
                                        <th>Reprint</th>
                                        <th>Cancel</th>
                                        <th class="wd-15p sorting">Voucher No.</th>
                                        <th class="wd-15p sorting">Expenses Slip No.</th>
                                        <th class="wd-15p sorting">Expenses Date</th>
                                        <th class="wd-15p sorting">expense name</th>
                                        <th class="wd-15p sorting">Vehicle No</th>
                                        <th class="wd-15p sorting">Container No.</th>
                                        <th class="wd-15p sorting">Size</th>
                                        <th class="wd-15p sorting">Activity</th>
                                        <th class="wd-15p sorting">Vendor Name</th>
                                        <th class="wd-15p sorting">Amount</th>
                                        <th class="wd-15p sorting">CGST</th>
                                        <th class="wd-15p sorting">SGST</th>
                                        <th class="wd-15p sorting">IGST</th>
                                        <th class="wd-15p sorting">GrandTotal</th>
                                        <th class="wd-15p sorting">Payment Mode</th>
                                        <th class="wd-15p sorting">Remark</th>
                                        <th class="wd-15p sorting">Invoice No</th>
                                        <th class="wd-15p sorting">Invoice Date</th>
                                        <th class="wd-15p sorting">Generated By</th>

                                        <th class="wd-15p sorting">Invoice No</th>
                                        <th class="wd-15p sorting">Invoice Date</th>
                                        <th class="wd-15p sorting">Party Name</th>
                                        <th class="wd-15p sorting">Collect Amount</th>
                                    </tr>
                                </thead>

                            </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<div class=" content-area" id="Editdiventry" style="display:none">
    <div class="page-header">
        <h4 class="page-title">Edit Transport Expenses</h4>
        <div class="ibox-content  text-right">
            <a onclick="getBack1();" class="btn btn-primary btn-success" style="color:white;align-content:center;"><i class="fa fa-arrow-left" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Back"></i>  </a></li>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-2 col-sm-12 ">
                            <label class="form-label">Container/vehicle No. </label>
                            <div class="input-group">
                                <input type="text" class="form-control br-tl-7 br-bl-7 float-right" placeholder="" id="EditContainerno" readonly>

                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12 ">

                            <label class="form-label">Voucher No.</label>
                            <div class="input-group">
                                <input type="text" class="form-control br-tl-7 br-bl-7 float-right" placeholder="" id="EditVoucherno" readonly>

                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12 ">
                            <label class="form-label">Trailer No.</label>
                            <div class="input-group">
                                <input type="text" class="form-control br-tl-7 br-bl-7 float-right" placeholder="" id="EditTrailerno" readonly>

                            </div>

                        </div>
                        <div class="col-lg-2 col-sm-12 ">
                            <label class="form-label">Size</label>
                            <div class="input-group">
                                <input type="text" class="form-control br-tl-7 br-bl-7 float-right" placeholder="" id="EditSize" readonly>

                            </div>

                        </div>
                        <div class="col-lg-2 col-sm-12 ">
                            <label class="form-label">Activity</label>
                            <div class="input-group">
                                <input type="text" class="form-control br-tl-7 br-bl-7 float-right" placeholder="" id="EditActivity" readonly>

                            </div>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Expense Date</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @*@Html.TextBox("txtissue", null, new { @class = "form-control", @id = "txtissue", name = "txtissue", autocomplete = "off", @maxlength = 500,  @readonly = "Readonly" })*@
                                        @Html.TextBox("txtissue1", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy hh:mm") })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Expenses Head</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlexpensesfor1", (IEnumerable<SelectListItem>)ViewBag.ExpensesList, "--Select--", new { @class = "form-control", @id = "ddlexpensesfor1", name = "ddlexpensesfor1" })


                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Vendor Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlvendorNameEdit", (IEnumerable<SelectListItem>)ViewBag.VendorLists, "--Select--", new { @class = "form-control", @id = "ddlvendorNameEdit", name = "ddlvendorNameEdit" })


                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Tax Name</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlTaxNameEdit", (IEnumerable<SelectListItem>)ViewBag.TaxIDs, "--Select--", new { @class = "form-control", @id = "ddlTaxNameEdit", name = "ddlTaxNameEdit" })


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Amount</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtAmount1", null, new { @class = "form-control", @id = "txtAmount1", name = "txtAmount1", autocomplete = "off", onkeypress = "isValidAmount()" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">CGST</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtCGSTAmountedit", null, new { @class = "form-control", @id = "txtCGSTAmountedit", name = "txtCGSTAmountedit", autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">SGST</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtSGSTAmounteddit", null, new { @class = "form-control", @id = "txtSGSTAmounteddit", name = "txtSGSTAmounteddit", autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">IGST</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtIGSTAmountEdit", null, new { @class = "form-control", @id = "txtIGSTAmountEdit", name = "txtIGSTAmountEdit", autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Total Amount</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtGRANDAmountEdit", null, new { @class = "form-control", @id = "txtGRANDAmountEdit", name = "txtGRANDAmountEdit", autocomplete = "off", onkeypress = "isValidAmount()", @type = "Number" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label class="form-label">Payment Mode</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.DropDownList("ddlpaymentmode1", (IEnumerable<SelectListItem>)ViewBag.PaymentMode, "--Select--", new { @class = "form-control", @id = "ddlpaymentmode1", name = "ddlpaymentmode1" })


                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Invoice No</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("TxtInvocieno1", null, new { @class = "form-control", @id = "TxtInvocieno1", name = "TxtInvocieno1", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-5 col-sm-12">
                            <div class="form-group">
                                <label class="form-label mandatory">Remark</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        @Html.TextBox("txtremark1", null, new { @class = "form-control", @id = "txtremark1", name = "txtremark1", autocomplete = "off" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-1 col-lg-1">
                            <label class="form-label" style="visibility:hidden">Save</label>
                            <div class="form-group label-floating">
                                <button class="btn btn-primary " type="button" id="EditAdd" onclick="AddEditedDetails()" name="Add">Add</button>
                            </div>
                        </div>



                    </div>

                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div>
                                <label class="form-label">Details </label>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered" id="Edittablexpensehead" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th class="wd-15p sorting">Voucher No.</th>
                                            <th class="sorting">Expenses Head</th>
                                            <th class="wd-15p sorting">Trailer No.</th>
                                            <th class="wd-15p sorting">Container No.</th>
                                            <th class="wd-15p sorting">Size</th>
                                            <th class="wd-15p sorting">Activity</th>
                                            <th class="wd-15p sorting">Vendor Name</th>

                                            <th class="wd-10p sorting">Amount</th>
                                            <th class="wd-10p sorting">CGST</th>
                                            <th class="wd-10p sorting">SGST</th>
                                            <th class="wd-10p sorting">IGST</th>
                                            <th class="wd-10p sorting">Grand Total</th>
                                            <th class="wd-15p sorting">Remarks</th>
                                            <th class="wd-15p sorting">Auto ID</th>
                                            <th class="wd-15p sorting">PaymentMode</th>
                                            <th class="wd-15p sorting">Vendor ID</th>
                                            <th class="wd-15p sorting">Tax ID</th>
                                            <th class="wd-15p sorting">Invoice No</th>
                                            <th></th>

                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2 col-lg-4">
                            <div class="form-group">
                                <label class="form-label"></label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <input type="submit" id="btnSave" name="save" value="Save" class="btn btn-success" onclick="EditSaveExpensesDetails()" />
                                        <input type="text" id="EditEntryid" style="visibility:hidden" />
                                        <input type="text" id="EditActivityid" style="visibility:hidden" />
                                        <input type="text" id="EditExpenseid" style="visibility:hidden" />

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- table-wrapper -->
        </div>
        <!-- section-wrapper -->
    </div>
</div>






<div class="modal fade" id="exampleModal3" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="example-Modal3">Upload File</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label for="recipient-name" class="form-control-label">Transid</label>
                                <input type="text" class="form-control" id="TxtuploadEntryid" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-5 col-sm-12" id="divAddDriverss">
                            <div class="form-group">
                                <label class="form-label mandatory">Upload Files</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <div class="form-group" id="divFileUpload">
                                            <input type="file" id="fileJOAttachment" name="postedFile" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12" id="divAddDriverss">
                            <div class="form-group">
                                <label class="form-label mandatory" style="visibility:hidden">.</label>
                                <div class="row gutters-xs">
                                    <div class="col">
                                        <div class="form-group" id="divFileUpload">
                                            <input type="Button" id="btnUpload" value="Upload" class="btn btn-primary" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="exampleModal4" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModal4">View File</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <div class="table-responsive">
                            <table id="JOAttachment" class="table table-striped table-bordered" style="width:100%">
                                <thead>
                                    <tr>
                                        <th style="width:5px" class=" sorting">#</th>
                                        <th class="wd-15p sorting">File Name</th>
                                        <th style="visibility:hidden; width:5px"></th>
                                        @* <th style="visibility:hidden"></th>*@
                                    </tr>
                                </thead>
                                <tbody style="box-sizing :border-box;"></tbody>
                            </table>

                        </div>

                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

            </div>
        </div>
    </div>
</div>


@using (Html.BeginForm("DownLoadFileTransportExpenses", "Transporter", FormMethod.Post))
{
    <input type="hidden" id="hfFileId" name="id" />
    <input type="hidden" id="hfFileId1" name="id1" />
    <input type="submit" id="btnDownload" value="Download" style="display:none" />
}

<script type="text/javascript">
    $(document).ready(function () {
        $('#example1').DataTable({
            "bLengthChange": false,
            "bInfo": false,
            "bPaginate": false,
            //"bFilter": false,
            "paging": false

        });

        $('#JOAttachment').DataTable({
            "bLengthChange": false,
            "bInfo": false,
            "bPaginate": false,
            //"bFilter": false,
            "paging": false

        });

        $('#tablexpensehead').DataTable({
            "bLengthChange": false,
            "bInfo": false,
            "bPaginate": false,
            //"bFilter": false,
            "paging": false

        });
        $('#Edittablexpensehead').DataTable({
            "bLengthChange": false,
            "bInfo": false,
            "bPaginate": false,
            //"bFilter": false,
            "paging": false

        });

    });

    $(window).on("load", function (e) {
        $("#tracker-loader").fadeOut("slow");
    })
    //  function checkboxlenght() {
    //      var checkboxchecked = $('[name="checklist[]"]:checked').length;
    //      if (checkboxchecked > 1) {
    //          alert("please select only one Voucher No!");
    //          checklist[i].checked = false;
    //      }

    //}
    //$('input.example').on('change', function () {
    //    $('input.example').not(this).prop('checked', false);
    //});


    $("#ddlexpensestype").change(function (e) {
        debugger;
        var searchon = $("#ddlexpensestype").val();
     

        if (searchon == "Other Expenses") {
            $("#divoffloading").hide();
            $("#divotherexpneses").show();
        }
        if (searchon == "offloading"  ) {
            $("#divoffloading").show();
            $("#divotherexpneses").hide();
 
        }

    });


</script>


<script type="text/javascript">


    function SaveExpenses() {
        debugger;
        var res = validate()
        if (res == false) {
            return false
        }

        var checkboxarray = [];
        $('input[type=checkbox]').each(function () {
            if (this.checked) {

                checkboxarray.push($(this).val());
            }
        });


        var tablearray = [];
        var table = document.getElementById("example1");
        var row;

        for (var i = 0; i < table.rows.length; i++) {

            row = table.rows[i];

            for (var k = 0; k < checkboxarray.length; k++) {

                var autodi = row.cells[11].innerText;

                if (autodi == checkboxarray[k]) {

                    var Voucherno = row.cells[1].innerText;
                    var ContainerNo = row.cells[4].innerText;
                    //tablearray.push({ 'VoucherNumber': VoucherNumber, 'TrailerNo': TrailerNo, 'ContainerNo': ContainerNo, 'Size': Size, 'Activity': Activity })

                }

            }
        }
       var Type= $("#ddlexpensestype").val();
  
    
        var ExpenseFordata = $("#ddlexpensesfor").val();
        var Data1 = { 'Voucherno': Voucherno, 'ExpenseFordata': ExpenseFordata, 'ContainerNo': ContainerNo, 'Type': Type }
        var data = JSON.stringify(Data1);


         $.ajax({
             url: "/Transporter/CheckVoucherDetails",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == 1) {
                    alert("Record already exists in system!")
                } else {
                    ShowAddedDetails();
                }
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });


    }

    function SaveExpensesDetails() {
        //$('#btnSave').prop('disabled', true);
        var ExpensesDate = $("#txtissue").val();
        var ExpensesFor = $("#ddlexpensesfor option:selected").val();
        var Amount = $("#txtAmount").val();
        var Remark = $("#txtremark").val();
        var PaymentMode = $("#ddlpaymentmode").val();
        var InvoiceDate = $("#TxtInvoiceDate").val();
        var InvoiceNo = $("#TxtInvocieno").val();
        var ddlGSTNo = $("#ddlGSTNo").val();


        var itemcount = checkItemcount();

        if (itemcount == false) {
        alert("please add expenses head in table")}
      else{

            var SelectedData = new Array();
            var tablearray = new Array();

            var table = document.getElementById("tablexpensehead");

            var row;
            for (var i = 1; i < table.rows.length; i++) {

                row = table.rows[i];
                   VoucherNumber = row.cells[0].innerText;
                    expenseFor = row.cells[1].innerText;
                    TrailerNo = row.cells[2].innerText;
                    ContainerNo = row.cells[3].innerText;
                    Size = row.cells[4].innerText;
                    Activity = row.cells[5].innerText;
                    Amount = row.cells[7].innerText;
                    Remarks = row.cells[12].innerText;
                    PaymentMode = row.cells[14].innerText;
                    vendorID = row.cells[16].innerText;
                    Taxid = row.cells[15].innerText;
                    CGST = row.cells[8].innerText;
                    SGST = row.cells[9].innerText;
                    IGST = row.cells[10].innerText;
                    GrandTotal = row.cells[11].innerText;

                SelectedData.push({
                    'VoucherNumber': VoucherNumber, 'expenseFor': expenseFor, 'TrailerNo': TrailerNo, 'ContainerNo': ContainerNo,
                    'Size': Size, 'Activity': Activity, 'Amount': Amount, 'Remarks': Remarks, 'PaymentMode': PaymentMode, 'vendorID': vendorID, 'Taxid': Taxid, 'CGST': CGST,
                    'SGST': SGST, 'IGST': IGST, 'GrandTotal': GrandTotal
                })
            }

            var data1 = { 'Invoicedata': SelectedData, 'InvoiceDate': InvoiceDate, 'InvoiceNo': InvoiceNo, 'ddlGSTNo': ddlGSTNo };
            $('#btnSave').prop('disabled', true);
            var data = JSON.stringify(data1);

                          $.ajax({
                              url: "/Transporter/SaveTransportData1",
                            data: data,
                            type: "POST",
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (data) {

                                alert(data);
                                if (data == "Record saved successfully") {
                                     $.ajax({
                                        url: "/Transporter/ExpencePrintDetails",
                                        // data: data2,
                                        type: "POST",
                                        contentType: "application/json; charset=utf-8",
                                        // dataType: "json",
                                        success: function (response) {

                                            var myWindow = window.open("", "MsgWindow");
                                            myWindow.close();
                                            var myWindow = window.open("", "MsgWindow");
                                            myWindow.document.write(response);
                                        },

                                        error: function (errormessage) {
                                            alert(errormessage.responseText);
                                        }
                                    });
                                     document.location = '@Url.Action("TransportExpenses", "Transporter")';
                                    $('#btnSave').prop('disabled', false);
                                    var r = confirm("Do you want to add more expenses for this voucher No!");
                                    if (r == true) {
                                        $("#ddlexpensesfor").val("");
                                        $("#txtAmount").val('');
                                        $("#txtremark").val('');
                                        $('#btnSave').prop('disabled', false);
                                    } else {
                                        document.location = '@Url.Action("TransportExpenses", "Transporter")';
                                    }
                                }else {
                                        document.location = '@Url.Action("TransportExpenses", "Transporter")';
                                    }




                                //ExpencePrint(data);
                            },
                            error: function (errormessage) {
                                alert(errormessage.responseText);
                            }
                        });

        }
    }

    //function ExpencePrint(EntryID) {

    //    var data1 = { 'EntryID': EntryID };
    //    var data = JSON.stringify(data1);

    //}


</script>


<script>

    function isValidAmount() {
        $("#txtAmount ").on("keyup", function () {
            //alert(1);
            var valid = /^\d{0,10}(\.\d{0,2})?$/.test(this.value),
                val = this.value;

            if (!valid) {
                alert("Enter valid data!");
                this.value = val.substring(0, val.length - 1);
            }
            if (this.value == '.') {
                //alert("Enter valid data!");
                this.value = val.substring(0, val.length - 1);
            }



        });
    }

    //function addexpense() {
    //    $("#divaddexpense").show();

    //}
    //function addexpenseEdit() {
    //    $("#divaddexpenseEdit").show();

    //}

    function ShowExpenseFor() {
        var expensename = $("#txtexpense").val();
        //alert(expensename);
        data1 = { 'expensename': expensename };
        data = JSON.stringify(data1);
        $.ajax({
            url: "/Transporter/SaveExpenseName",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //alert("Record added successfully!")
                alert(data);
                $('#txtexpense').val('');

            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
        AddExpenseDropDown();
    }

    function ShowExpenseForEdit() {
        var expensename = $("#txtexpense1").val();
        //alert(expensename);
        data1 = { 'expensename': expensename };
        data = JSON.stringify(data1);
        $.ajax({
            url: "/Transporter/SaveExpenseName",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //alert("Record added successfully!")
                alert(data);
                $('#txtexpense1').val('');

            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
        AddExpenseDropDown1();
    }


</script>


<script>




    function showView() {

        $("#divView").show();
        $("#diventry").hide();


    }


    function ShowExpenseSummary() {
        $("#tracker-loader").fadeIn("slow");
        var FromDate = $("#FromDate").val()
        var ToDate = $("#ToDate").val()
        data1 = { 'FromDate': FromDate, 'ToDate': ToDate };
        data = JSON.stringify(data1);
        $.ajax({

            url: '/Transporter/GetTransportExpenses',
            type: 'Post',
            data: data,
            async: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                $('#example').dataTable({
                    "destroy": true,
                    "bLengthChange": false,
                    "aaData": data,
                    "bInfo": false,
                    "bPaginate": false,
                    "bFilter": true,
                    "paging": false,
                    "columns": [
                        {
                            "data": "Entryid",
                            "render": function (data, type, row, meta) {
                                if (type === 'display') {

                                    data = '<a   href="#" class="btn btn-sm btn-teal" title="Edit"  data-toggle="modal" data-target="#exampleModal3"  onclick="UploadAttchment(' + row.Entryid + ')"><i class="fa fa-paperclip"></i></a>';
                                }

                                return data;
                            }


                        },
                        {
                            "data": "Entryid",
                            "render": function (data, type, row, meta) {
                                if (type === 'display') {

                                    data = '<a   href="#" class="btn btn-sm btn-info" title="Edit"  data-toggle="modal" data-target="#exampleModal4" onclick="ViewExpensesAttachment(' + row.Entryid + ')"><i class="fa fa-eye"></i></a>';
                                }

                                return data;
                            }


                        },
                        {
                            "data": "Entryid",
                            "render": function (data, type, row, meta) {
                                if (type === 'display') {

                                    data = '<a   href="#" class="btn btn-sm btn-orange" title="Edit" onclick="EditExpenses(' + row.Entryid + ',' + row.transexpenseID + ')"><i class="fa fa-edit"></i></a>';
                                }

                                return data;
                            }


                        },

                        {
                            "data": "Entryid",
                            "render": function (data, type, row, meta) {
                                if (type === 'display') {

                                    data = '<a  onclick="Reprint(' + row.Entryid + ')"  href="#" class="btn btn-sm btn-primary dis" title="Print" ><i class="fa fa-print"></i></a>';
                                }

                                return data;
                            }


                        },
                        {
                            "data": "Entryid",
                            "render": function (data, type, row, meta) {
                                if (type === 'display') {

                                    data = '<a  onclick="Delete(' + row.Entryid + ',' + row.transexpenseID + ')"  href="#" class="btn btn-sm btn-danger btn-disabled" title="Cancel" ><i class="fa fa-times"></i></a>';
                                }

                                return data;
                            }


                        },



                        { "data": "VoucherNumber" },
                        { "data": "ExpenseSlipNo" },
                        { "data": "EntryDate" },
                        { "data": "transexpensename" },
                        { "data": "TrailerNo" },
                        { "data": "ContainerNo" },
                        { "data": "Size" },
                        { "data": "ActivityMaster" },
                        { "data": "vendorID" },
                        { "data": "Amount" },
                        { "data": "CGST" },
                        { "data": "SGST" },
                        { "data": "IGST" },
                        { "data": "GrandTotal" },
                        { "data": "PaymentMode" },
                        { "data": "Remark" },
                        { "data": "Username" },
                        { "data": "InvoiceNo" },
                        { "data": "InvoiceDate" },

                        { "data": "CollectInvoiceNo" },
                        { "data": "CollectInvoiceDate" },
                        { "data": "CollectParty" },
                        { "data": "CollectAmount" },
                    ]
                });
                $("#tracker-loader").fadeOut("slow");
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }


        });
    }

    function getBack() {
        $("#divView").hide();
        $("#diventry").show();
    }

    function getBack1() {
        $("#divView").show();
        $("#Editdiventry").hide();
        $("#diventry").hide();
    }


    function Delete(Entryid, transexpenseID) {
        data1 = { 'Entryid': Entryid, 'transexpenseID': transexpenseID };
        data = JSON.stringify(data1);
        //alert(data);
        $.ajax({
            url: "/Transporter/CancelTransportExpense",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                alert("Record Saved Successfully!")

            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }
</script>


<script>


    function ShowVoucherNo() {
        var res1 = validatecontainer();
        if (res1 == false) {
            return false
        }
        $("#tracker-loader").fadeIn("slow");

        var Containerno = $("#Containerno").val();
        $.ajax({
            url: "/Transporter/AjaxVoucherDetails",
            data: '{Containerno: ' + JSON.stringify(Containerno) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //var select = $("#ddlVoucherno");

                //select.empty();
                //select.append($('<option/>', {
                //    value: 0,
                //    text: "--Select--"
                //}));

                //$.each(data, function (data, value) {

                //    select.append($("<option></option>").val(value.Voucherid).html(value.VoucherNumber));
                //})
                $('#example1').dataTable({
                    "destroy": true,
                    "bLengthChange": false,
                    "aaData": data,
                    "bInfo": false,
                    "bPaginate": false,
                    "bFilter": true,
                    "paging": false,
                    "columns": [
                        {

                            "data": "AutoID",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\"   value="' + data + '">';
                                return data;

                            }
                        },
                        { "data": "VoucherNumber" },
                        { "data": "VoucherDate" },
                        { "data": "TrailerName" },

                        { "data": "ContainerNo" },
                        { "data": "Size" },
                        { "data": "Drivername" },
                        { "data": "FromLocation" },
                        { "data": "ToLocation" },
                        { "data": "Activity" },
                        { "data": "Party" },
                        { "data": "AutoID" },


                    ]
                });
                $("#tracker-loader").fadeOut("slow");

            },

            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });

    }

    function ShowVOffloadingoucherNo() {
        var res1 = validatecontainer1();
        if (res1 == false) {
            return false
        }
        $("#tracker-loader").fadeIn("slow");

        var Containerno = $("#txtoffloadingContainerno").val();
        $.ajax({
            url: "/Transporter/AjaxOffloadingDetails",
            data: '{Containerno: ' + JSON.stringify(Containerno) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //var select = $("#ddlVoucherno");

                //select.empty();
                //select.append($('<option/>', {
                //    value: 0,
                //    text: "--Select--"
                //}));

                //$.each(data, function (data, value) {

                //    select.append($("<option></option>").val(value.Voucherid).html(value.VoucherNumber));
                //})
                $('#example1').dataTable({
                    "destroy": true,
                    "bLengthChange": false,
                    "aaData": data,
                    "bInfo": false,
                    "bPaginate": false,
                    "bFilter": true,
                    "paging": false,
                    "columns": [
                        {

                            "data": "AutoID",
                            "render": function (data, type, row, meta) {
                                data = '<input type=\"checkbox\" name=\"checklist[]\" class=\"checklist\" id=\"checklist\"   value="' + data + '">';
                                return data;

                            }
                        },
                        { "data": "VoucherNumber" },
                        { "data": "VoucherDate" },
                        { "data": "TrailerName" },

                        { "data": "ContainerNo" },
                        { "data": "Size" },
                        { "data": "Drivername" },
                        { "data": "FromLocation" },
                        { "data": "ToLocation" },
                        { "data": "Activity" },
                        { "data": "Party" },
                        { "data": "AutoID" },


                    ]
                });
                $("#tracker-loader").fadeOut("slow");

            },

            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });

    }


    function AddExpenseDropDown() {
        $("#divaddexpense").hide();
        $.ajax({
            url: "/Transporter/AjaxExpensefor",
            // data: '{Containerno: ' + JSON.stringify(Containerno) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                var select = $("#ddlexpensesfor");

                select.empty();
                select.append($('<option/>', {
                    value: 0,
                    text: "--Select--"
                }));

                $.each(data, function (data, value) {

                    select.append($("<option></option>").val(value.transexpenseid).html(value.transexpensename));
                })



            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });

    }


    function AddExpenseDropDown1() {
        $("#divaddexpense").hide();
        $.ajax({
            url: "/Transporter/AjaxExpensefor",
            // data: '{Containerno: ' + JSON.stringify(Containerno) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                var select = $("#ddlexpensesfor1");

                select.empty();
                select.append($('<option/>', {
                    value: 0,
                    text: "--Select--"
                }));

                $.each(data, function (data, value) {

                    select.append($("<option></option>").val(value.transexpenseid).html(value.transexpensename));
                })



            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });

    }
    //function selectOnlyThis(id) {
    //    for (var i = 1; i <= 20; i++) {
    //        document.getElementById("checklist" + i).checked = false;
    //    }
    //    document.getElementById(id).checked = true;
    //}
    //onclick =\"checkboxlenght()\"
    //function checkboxlenght() {
    // var checkboxchecked = $('[name="checklist[]"]:checked').length;
    // if (checkboxchecked > 1) {
    //     alert("please select only one Voucher No!");
    //     document.getElementById("checklist").checked = false;
    // }

    //}

    $(document).on('click', 'input[type="checkbox"]', function () {
        $('input[type="checkbox"]').not(this).prop('checked', false);
    });

</script>


<script>
    function validate() {

        //var Vouchernovalidate = document.getElementById('ddlVoucherno').value;
        var expensedatevalidate = document.getElementById('txtissue').value;
        var expensefor = document.getElementById('ddlexpensesfor').value;
        var amount = document.getElementById('txtAmount').value;
        var remark = document.getElementById('txtremark').value;
        var Paymentmode = document.getElementById('ddlpaymentmode').value;


        var b1result = Boolean;
        blResult = true;
        //document.getElementById('ddlVoucherno').style.borderColor = "Gainsboro";
        document.getElementById('txtissue').style.borderColor = "Gainsboro";
        document.getElementById('ddlexpensesfor').style.borderColor = "Gainsboro";
        document.getElementById('txtAmount').style.borderColor = "Gainsboro";
        document.getElementById('txtremark').style.borderColor = "Gainsboro";
        document.getElementById('ddlpaymentmode').style.borderColor = "Gainsboro";

        //if (Vouchernovalidate == "") {
        //    document.getElementById('ddlVoucherno').style.borderColor = "red"
        //    blResult = blResult && false;
        //}
        //if (Vouchernovalidate == "0") {
        //    document.getElementById('ddlVoucherno').style.borderColor = "red"
        //    blResult = blResult && false;
        //}
        if (expensedatevalidate == "") {
            document.getElementById('txtissue').style.borderColor = "red"
            blResult = blResult && false;
        }
        if (expensefor == "") {
            document.getElementById('ddlexpensesfor').style.borderColor = "red"
            blResult = blResult && false;
        }
        if (amount == "") {
            document.getElementById('txtAmount').style.borderColor = "red"
            blResult = blResult && false;
        }

        if (remark == "") {
            document.getElementById('txtremark').style.borderColor = "red"
            blResult = blResult && false;
        }

        if (Paymentmode == "") {
            document.getElementById('ddlpaymentmode').style.borderColor = "red"
            blResult = blResult && false;
        }



        if (blResult == false) { alert('Please fill the required fields!'); }
        return blResult;

    }


    function validatecontainer() {

        var containernovalidate = document.getElementById('Containerno').value;;
        var b1result1 = Boolean;
        blResult1 = true;
        document.getElementById('Containerno').style.borderColor = "Gainsboro";


        if (containernovalidate == "") {
            document.getElementById('Containerno').style.borderColor = "red"
            blResult1 = blResult1 && false;
        }
        if (blResult1 == false) { alert('Please add the container/Vehicle No to select Voucher No!'); }
        return blResult1;
    }

    function validatecontainer1() {

        var containernovalidate = document.getElementById('txtoffloadingContainerno').value;;
        var b1result1 = Boolean;
        blResult1 = true;
        document.getElementById('txtoffloadingContainerno').style.borderColor = "Gainsboro";


        if (containernovalidate == "") {
            document.getElementById('txtoffloadingContainerno').style.borderColor = "red"
            blResult1 = blResult1 && false;
        }
        if (blResult1 == false) { alert('Please add the container No'); }
        return blResult1;
    }


    function Reprint(Entryid) {

        var data1 = { 'Entryid': Entryid };
        var data = JSON.stringify(data1);
        $.ajax({
            url: "/Transporter/ReExpencePrintDetails",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            // dataType: "json",
            success: function (response) {

                var myWindow = window.open("", "MsgWindow");
                myWindow.close();
                var myWindow = window.open("", "MsgWindow");
                myWindow.document.write(response);
            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }




</script>


<script>
    var storeAddedItem = [];
    function ShowAddedDetails() {
        //table
        //take vochetr no


        var Type = $("#ddlexpensestype option:selected").val();

        var tempno = "";
        var Contain = "";
        if (storeAddedItem.length != 0) {
            tempno = storeAddedItem[0].VoucherName;
            Contain = storeAddedItem[0].ContainerName;
        }


        var res = validate()
        if (res == false) {
            return false
        }

        var checkboxarray = [];
        $('input[type=checkbox]').each(function () {
            if (this.checked) {

                checkboxarray.push($(this).val());
            }
        });


        var tablearray = [];
        var table = document.getElementById("example1");
        var row;
        for (var i = 0; i < table.rows.length; i++) {
            row = table.rows[i]; ddlpaymentmode
            for (var k = 0; k < checkboxarray.length; k++) {
                var autodi = row.cells[11].innerText;
                if (autodi == checkboxarray[k]) {
                    //if for vocher
                    var VoucherNumber = row.cells[1].innerText;
                    TrailerNo = row.cells[3].innerText;
                    ContainerNo = row.cells[4].innerText;
                    Size = row.cells[5].innerText;
                    Activity = row.cells[9].innerText;
                    var autoid = row.cells[11].innerText;
                    tablearray.push({ 'VoucherNumber': VoucherNumber, 'TrailerNo': TrailerNo, 'ContainerNo': ContainerNo, 'Size': Size, 'Activity': Activity, 'autoid': autoid })

                }
            }
        }


        var current = tablearray[0].VoucherNumber;
        var currentContainerNo = tablearray[0].ContainerNo;
        var AutoIDnakili = $("#ddlexpensesfor option:selected").text();
         if (tempno == current || Contain == currentContainerNo || storeAddedItem.length == 0) {
            //Check ki same bill na print ho
            for (s = 0; s < storeAddedItem.length; s++) {
                var tempExp = storeAddedItem[s].ExpensesHeadName;
                if (tempExp == AutoIDnakili && Type != "offloading") {

                    alert("Already added the expenses head for this voucher No!");
                    return false;
                }
            }

            //

            var element = {};
            element.ExpensesHeadID = $("#ddlexpensesfor option:selected").val();
            element.amount1 = $("#txtAmount").val();
            element.remarks1 = $("#txtremark").val()


            element.VoucherName = tablearray[0].VoucherNumber;
            element.TrailerName = tablearray[0].TrailerNo;
            element.ContainerName = tablearray[0].ContainerNo;
            element.SizeNsme = tablearray[0].Size;
            element.ActivityName = tablearray[0].Activity;
            element.ExpensesHeadName = $("#ddlexpensesfor option:selected").text();

            element.Amount2 = $("#txtAmount").val();
            element.Remarkss = $("#txtremark").val();
            element.PaymentMode = $("#ddlpaymentmode option:selected").val();
            element.AutoIDname = tablearray[0].autoid;
            element.vendorName = $("#ddlvendorName").val();
            element.vendorID = $("#hdnExpensesHead").val();
            element.TaxName = $("#ddlTaxName option:selected").val();
            element.SGST = $("#txtSGSTAmount").val();
            element.CGST = $("#txtCGSTAmount").val();
            element.IGST = $("#txtIGSTAmount").val();
            element.GrandTotal = $("#txtGRANDAmount").val();
            storeAddedItem.push(element);
            $('#tablexpensehead').DataTable({
                "destroy": true,
                "bLengthChange": false,
                "aaData": storeAddedItem,
                "bPaginate": false,
                "bInfo": false,
                "paging": false,
                "columns": [
                    { "data": "VoucherName" },
                    { "data": "ExpensesHeadName" },
                    { "data": "TrailerName" },
                    { "data": "ContainerName" },
                    { "data": "SizeNsme" },
                    { "data": "ActivityName" },
                    { "data": "vendorName" },
                    { "data": "Amount2" },
                    { "data": "CGST" },
                    { "data": "SGST" },
                    { "data": "IGST" },
                    { "data": "GrandTotal" },
                    { "data": "Remarkss" },
                    { "data": "AutoIDname" },
                    { "data": "PaymentMode" },
                    { "data": "TaxName" },
                    { "data": "vendorID" },
                    {
                        "data": "AutoIDname",
                        "orderable": false,
                        "render": function (data, type, row, meta) {
                            if (type === 'display') {
                                data = "<button type=\"button\" class=\"btn btn-icon btn-primary btn-danger removebutton \" name=\"removebutton\" style=\"height:35px;\" onclick=\"deleteSelecetedItem('" + row.AutoIDname + "')\"><i class=\"fe fe-trash\" style=\"font-size: 16px;\"></i></button>"
                            }
                            return data;
                        }
                    }
                ]
            });
        } else {
            alert("cannot add different Voucher No!");
        }





    }



    function deleteSelecetedItem(id) {
        for (i = 0; i < storeAddedItem.length; i++) {
            if (this.storeAddedItem[i].AutoIDname == id) {
                storeAddedItem.splice(i, 1);
            }
        }
        $('#tablexpensehead').DataTable({
            "destroy": true,
            "bLengthChange": false,
            "aaData": storeAddedItem,
            "bPaginate": false,
            "bInfo": false,
            "paging": false,
            "columns": [
                { "data": "VoucherName" },
                { "data": "ExpensesHeadName" },
                { "data": "TrailerName" },
                { "data": "ContainerName" },
                { "data": "SizeNsme" },
                { "data": "ActivityName" },
                { "data": "vendorName" },
                { "data": "Amount2" },
                { "data": "CGST" },
                { "data": "SGST" },
                { "data": "IGST" },
                { "data": "GrandTotal" },
                { "data": "Remarkss" },
                { "data": "AutoIDname" },
                { "data": "PaymentMode" },
                { "data": "TaxName" },
                { "data": "vendorID" },
                {
                    "data": "AutoIDname",
                    "orderable": false,
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = "<button type=\"button\" class=\"btn btn-icon btn-primary btn-danger removebutton \" name=\"removebutton\" style=\"height:35px;\" onclick=\"deleteSelecetedItem('" + row.AutoIDname + "')\"><i class=\"fe fe-trash\" style=\"font-size: 16px;\"></i></button>"
                        }
                        return data;
                    }
                }
            ]
        });
    }
    function checkItemcount() {

        var table = $('#tablexpensehead').DataTable();

        if (table.rows().count() == 0) {

            return false;
        }
        return true;

    }
    function CancelItem(ExpensesHeadName) {
        var table = $('#tablexpensehead').DataTable();
        $('#tablexpensehead tbody').on('click', '.removebutton', function () {

            table
                .row($(this).parents('tr'))
                .remove()
                .draw();


        });
    }
</script>


<script>
    function SaveExpensesEdit(Entryid, transexpenseID) {


        var data1 = { 'Entryid': Entryid, 'transexpenseID': transexpenseID};
        var data = JSON.stringify(data1);
        $.ajax({

            url: '/Transporter/EditExpenseHead',
            type: 'Post',
            data: data,
            async: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                $("#txtAmount1").val(data[0].Amount);
                $("#txtremark1").val(data[0].Remark);

                $("#ddlexpensesfor1").val(data[0].ExpensesheadID);
                $("#txtAmount1").val(data[0].Amount);
                $("#txtremark1").val(data[0].Remark);
                $("#EditVoucherno").val(data[0].VoucherNumber);
                $("#EditTrailerno").val(data[0].TrailerNo);
                $("#EditContainerno").val(data[0].ContainerNo);
                $("#EditSize").val(data[0].Size);
                $("#EditActivity").val(data[0].ActivityMaster);
                $("#EditEntryid").val(data[0].Entryid);
                $("#ddlpaymentmode1").val(data[0].PaymentmodeID);
                $("#EditActivityid").val(data[0].AutoActivityid);
                $("#EditExpenseid").val(data[0].ExpensesheadID);
                $("#ddlTaxNameEdit").val(data[0].Taxid);
                $("#ddlvendorNameEdit").val(data[0].vendorID);
                $("#txtCGSTAmountedit").val(data[0].CGST);
                $("#txtSGSTAmounteddit").val(data[0].SGST);
                $("#txtIGSTAmountEdit").val(data[0].IGST);
                $("#txtGRANDAmountEdit").val(data[0].GrandTotal);
                $("#TxtInvocieno1").val(data[0].InvoiceNo);
                //$("#ddlexpensesfor1").attr('disabled', true);
                $("#tracker-loader").fadeOut("slow");
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }


        });
    }



    //function getfilldata() {
    //    var SelectedData = new Array();
    //    var tablearray = new Array();

    //    var table = document.getElementById("Edittablexpensehead");

    //    var row;
    //    for (var i = 1; i < table.rows.length; i++) {

    //        row = table.rows[i];
    //        VoucherNumber = row.cells[1].innerText;
    //        expenseFor = row.cells[2].innerText;
    //        TrailerNo = row.cells[3].innerText;
    //        ContainerNo = row.cells[4].innerText;
    //        Size = row.cells[5].innerText;
    //        Activity = row.cells[6].innerText;
    //        Amount = row.cells[7].innerText;
    //        Remarks = row.cells[8].innerText;
    //        Entryid = row.cells[9].innerText;
    //        PaymentMode = row.cells[10].innerText;

    //        SelectedData.push({
    //            'VoucherNumber': VoucherNumber, 'expenseFor': expenseFor, 'TrailerNo': TrailerNo,
    //            'ContainerNo': ContainerNo, 'Size': Size, 'Activity': Activity, 'Amount': Amount,
    //            'Remarks': Remarks, 'Entryid': Entryid, 'PaymentMode': PaymentMode
    //        })
    //    }
    //    storeAddedItemDetails.push(SelectedData);
    //}
    function EditExpenses(Entryid, transexpenseID) {
        $("#Editdiventry").show();
        $("#divView").hide();
        $("#diventry").hide();
        SaveExpensesEdit(Entryid, transexpenseID);

    }


    function EditExpensesdetails(Entryid, ExpensesheadID, Remark, Amount, VoucherNumber, TrailerNo, ContainerNo, Size, ActivityMaster, AutoActivityid, SrNo) {
        $("#ddlexpensesfor1").val(ExpensesheadID);
        $("#txtAmount1").val(Amount);
        $("#txtremark1").val(Remark);
        $("#EditVoucherno").val(VoucherNumber);
        $("#EditTrailerno").val(TrailerNo);
        $("#EditContainerno").val(ContainerNo);
        $("#EditSize").val(Size);
        $("#EditActivity").val(ActivityMaster);
        $("#EditEntryid").val(SrNo);
        $("#EditActivityid").val(AutoActivityid);


    }

    function CancelItemedit(SrNo) {
        var table = $('#Edittablexpensehead').DataTable();
        $('#Edittablexpensehead tbody').on('click', '.removebutton', function () {

                table
                    .row($(this).parents('tr'))
                    .remove()
                    .draw();

            });

    }


    var storeAddedItemDetails = [];
    function AddEditedDetails() {

        var res = EditFunctionvalidate()
        if (res == false) {
            return false
        }


        var Type = $("#ddlexpensestype option:selected").val();
        var itemcount = EditcheckItemcount();

        if (itemcount == false && Type != "offloading") {
            alert("please add only one expenses head in table")
        }
        else {
            var Editelement = {};

            Editelement.ContainerNo = $("#EditContainerno").val();
            Editelement.VoucherNumber = $("#EditVoucherno").val();
            Editelement.TrailerNo = $("#EditTrailerno").val();
            Editelement.Size = $("#EditSize").val();
            Editelement.transexpensename = $("#ddlexpensesfor1 option:selected").text();
            Editelement.transexpenseID = $("#ddlexpensesfor1 option:selected").val();
            Editelement.ActivityMaster = $("#EditActivity").val();
            Editelement.Amount = $("#txtAmount1").val();
            Editelement.Remark = $("#txtremark1").val();
            Editelement.PaymentMode = $("#ddlpaymentmode1 option:selected").text();
            Editelement.Entryid = $("#EditEntryid").val();
            Editelement.vendorName = $("#ddlvendorNameEdit option:selected").text();
            Editelement.vendorID = $("#ddlvendorNameEdit option:selected").val();
            Editelement.Taxid = $("#ddlTaxNameEdit option:selected").val();
            Editelement.CGST = $("#txtCGSTAmountedit").val();
            Editelement.SGST = $("#txtSGSTAmounteddit").val();
            Editelement.IGST = $("#txtIGSTAmountEdit").val();
            Editelement.GrandTotal = $("#txtGRANDAmountEdit").val();
            Editelement.Invocieno = $("#TxtInvocieno1").val();
            storeAddedItemDetails.push(Editelement);

            $('#Edittablexpensehead').DataTable({
                "destroy": true,
                "bLengthChange": false,
                "aaData": storeAddedItemDetails,
                "bPaginate": false,
                "bInfo": false,
                 "bFilter": false,
                "paging": false,
                "columns": [
                    {
                        "data": "Entryid",
                        "render": function (data, type, row, meta) {
                            if (type === 'display') {

                                data = '<a   href="#" class="btn btn-sm btn-info" title="Edit" disable onclick="EditExpensesdetailsss()"><i class="fa fa-edit"></i></a>';
                            }

                            return data;
                        }
                    },
                    { "data": "VoucherNumber" },
                    { "data": "transexpensename" },
                    { "data": "TrailerNo" },
                    { "data": "ContainerNo" },
                    { "data": "Size" },
                    { "data": "ActivityMaster" },
                    { "data": "vendorName" },
                    { "data": "Amount" },
                    { "data": "CGST" },
                    { "data": "SGST" },
                    { "data": "IGST" },
                    { "data": "GrandTotal" },
                    { "data": "Remark" },
                    { "data": "Entryid" },
                    { "data": "PaymentMode" },
                    { "data": "vendorID" },
                    { "data": "Taxid" },
                    { "data": "Invocieno" },

                    {
                        "data": "Entryid",
                        "orderable": false,
                        "render": function (data, type, row, meta) {
                            if (type === 'display') {
                                data = "<button type=\"button\" class=\"btn btn-icon btn-primary btn-danger removebutton \" name=\"removebutton\" style=\"height:35px;\" onclick=\"deleteSelecetedItemEdit('" + row.Entryid + "','" + row.transexpenseID + "')\"><i class=\"fe fe-trash\" style=\"font-size: 16px;\"></i></button>"
                            }
                            return data;
                        }
                    }

                ]
            });
        }
    }



    // to delete from the Grid table UI

    function deleteSelecetedItemEdit(Entryid, transexpenseID) {


        var data1 = { 'Entryid': Entryid, 'transexpenseID': transexpenseID};
        var data = JSON.stringify(data1);
        $.ajax({

            url: '/Transporter/DeleteExpenseHead',
            type: 'Post',
            data: data,
            async: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                alert("Record Deleted Successfully!");
                              document.location = '@Url.Action("TransportExpenses", "Transporter")'

            },
            error: function (errormessage) {
                alert(errormessage.responseText);

            }


        });
    }




    function EditFunctionvalidate() {

        var ValidateCOntainer = document.getElementById('EditContainerno').value;
        var Valivoucher = document.getElementById('EditVoucherno').value;

        var Validatesize = document.getElementById('EditSize').value;
        var validateexpense = document.getElementById('ddlexpensesfor1').value;
        var validateactivity = document.getElementById('EditActivity').value;
        var validateamount = document.getElementById('txtAmount1').value;
        var validateremarks = document.getElementById('txtremark1').value;
        var validatepayments = document.getElementById('ddlpaymentmode1').value;


        var b1result = Boolean;
        blResult = true;

        document.getElementById('EditContainerno').style.borderColor = "Gainsboro";
        document.getElementById('EditVoucherno').style.borderColor = "Gainsboro";

        document.getElementById('EditSize').style.borderColor = "Gainsboro";
        document.getElementById('ddlexpensesfor1').style.borderColor = "Gainsboro";
        document.getElementById('EditActivity').style.borderColor = "Gainsboro";
        document.getElementById('txtAmount1').style.borderColor = "Gainsboro";
        document.getElementById('txtremark1').style.borderColor = "Gainsboro";
        document.getElementById('ddlpaymentmode1').style.borderColor = "Gainsboro";


        if (ValidateCOntainer == "") {
            document.getElementById('EditContainerno').style.borderColor = "red"
            blResult = blResult && false;
        }
        if (Valivoucher == "") {
            document.getElementById('EditVoucherno').style.borderColor = "red"
            blResult = blResult && false;
        }


        if (Validatesize == "") {
            document.getElementById('EditSize').style.borderColor = "red"
            blResult = blResult && false;
        }

        if (validateexpense == "") {
            document.getElementById('ddlexpensesfor1').style.borderColor = "red"
            blResult = blResult && false;
        }
        //if (validateactivity == "") {
        //    document.getElementById('EditActivity').style.borderColor = "red"
        //    blResult = blResult && false;
        //}
        if (validateamount == "") {
            document.getElementById('txtAmount1').style.borderColor = "red"
            blResult = blResult && false;
        }
        if (validateremarks == "") {
            document.getElementById('txtremark1').style.borderColor = "red"
            blResult = blResult && false;
        }
        if (validatepayments == "") {
            document.getElementById('ddlpaymentmode1').style.borderColor = "red"
            blResult = blResult && false;
        }



        if (blResult == false) { alert('Please fill the required fields!'); }
        return blResult;

    }

</script>



<script>
    function EditSaveExpensesDetails() {


        var Editentryid = $("#EditEntryid").val();
        var Activityid = $("#EditActivityid").val();
        var ExpensesID = $("#EditExpenseid").val();
        var ExpensesDate = $("#txtissue1").val();


            var SelectedData = new Array();
            var tablearray = new Array();

            var table = document.getElementById("Edittablexpensehead");

            var row;
            for (var i = 1; i < table.rows.length; i++) {

                row = table.rows[i];
                   VoucherNumber = row.cells[1].innerText;
                    expenseFor = row.cells[2].innerText;
                    TrailerNo = row.cells[3].innerText;
                    ContainerNo = row.cells[4].innerText;
                    Size = row.cells[5].innerText;
                    Activity = row.cells[6].innerText;
                    Amount = row.cells[8].innerText;
                    Remarks = row.cells[13].innerText;
                    Entryid = row.cells[14].innerText;
                   PaymentMode = row.cells[15].innerText;

                  vendorID = row.cells[16].innerText;
                  Taxid = row.cells[17].innerText;
                  CGST = row.cells[9].innerText;
                  SGST = row.cells[10].innerText;
                  IGST = row.cells[11].innerText;
                  GrandTotal = row.cells[12].innerText;
                InvoiceNo = row.cells[18].innerText;
                SelectedData.push({
                    'VoucherNumber': VoucherNumber, 'expenseFor': expenseFor, 'TrailerNo': TrailerNo,
                    'ContainerNo': ContainerNo, 'Size': Size, 'Activity': Activity, 'Amount': Amount,
                    'Remarks': Remarks, 'Entryid': Entryid, 'PaymentMode': PaymentMode, 'vendorID': vendorID, 'Taxid': Taxid, 'CGST': CGST, 'SGST': SGST,
                    'IGST': IGST, 'GrandTotal': GrandTotal, 'InvoiceNo': InvoiceNo
                })
            }

        var data1 = { 'Invoicedata': SelectedData, 'Editentryid': Editentryid, 'Activityid': Activityid, 'ExpensesID': ExpensesID, 'ExpensesDate': ExpensesDate};
        var data = JSON.stringify(data1);

            $.ajax({
                url: "/Transporter/EditSaveTransportData",
            data: data,
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                alert(data);
                document.location = '@Url.Action("TransportExpenses", "Transporter")'

            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });


    }



    function EditcheckItemcount() {

        var table = $('#Edittablexpensehead').DataTable();

        if (table.rows().count() == 0) {

            return true;
        }
        return false;

    }


    $('#ddlvendorName').change(function (e) {
        var VendorID = $("#hdnExpensesHead").val();
        $.ajax({
            url: "/Transporter/GetVendorGSTDetails",
            data: '{VendorID: ' + JSON.stringify(VendorID) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {

                var select = $("#ddlGSTNo");

                select.empty();
                select.append($('<option/>', {
                    value: "",
                    
                }));

                $.each(data, function (data, value) {

                    select.append($("<option></option>").val(value.GSTuniqueid).html(value.GstuniqueName));
                })





            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });




    });



    function GetGSTDetails() {
        $("#tracker-loader").fadeIn("slow");

        var TaxID = $("#ddlTaxName option:selected").val();
        var data1 = { 'TaxID': TaxID };
        var data = JSON.stringify(data1);

        if (TaxID !== "") {
            $.ajax({
                type: "POST",
                url: "/Transporter/GetGSTDetailsForCalculate",
                data: data,
                contentType: "application/json; charset=utf-8",
                success: function (data) {

                    $("#TxtSgstGet").val(data.SGST);
                    $("#CGSTGet").val(data.CGST);
                    $("#IGSTGet").val(data.IGST);
                    $("#tracker-loader").fadeOut("slow");
                    Filldetailsintbl();
                },
                error: function (error) {
                    let str = error.responseText;
                    var a = str.indexOf("<title>") + 7;
                    var b = str.indexOf("</title>");
                    str = str.substring(a, b);
                    alert("Something went wrong: " + str);
                    $("#tracker-loader").fadeOut("slow");
                }
            })
        }
    }



    function Filldetailsintbl() {
        debugger;
        var dblNetTotal = 0;
        var dblIGST = 0;
        var dblSGST = 0;
        var dblCGST = 0;
        var SGSTcal1 = 0;

        var CGSTcal1 = 0;
        var IGSTcal1 = 0;


        var Amount = $("#txtAmount").val();

        var GSTNO = $("#ddlGSTNo option:selected").text();

        var SGSTcal = $("#TxtSgstGet").val();
        var CGSTcal = $("#CGSTGet").val();
        var IGSTcal = $("#IGSTGet").val();

        var checkGST = GSTNO.substring(0, 2)




        if (checkGST == "27" || checkGST == "") {
            var dblIGST = 0;
            var dblSGST = Number(Amount) * SGSTcal / 100;
            var dblCGST = Number(Amount) * CGSTcal / 100;

        } else {
            var dblIGST = Number(Amount) * IGSTcal / 100;
            var dblSGST = 0;
            var dblCGST = 0;

        }



        $("#txtNetAmount").val(Number(Amount));
        $("#txtSGSTAmount").val(dblSGST.toFixed(2));
        $("#txtCGSTAmount").val(dblCGST.toFixed(2));
        $("#txtIGSTAmount").val(dblIGST.toFixed(2));

        var GrandTotal =  (Number(Amount)) + dblSGST + dblCGST +  dblIGST ;
        var GrandAmount =  (GrandTotal.toFixed());
        $("#txtGRANDAmount").val(GrandAmount);



    }
</script>


<script>
    function UploadAttchment(Entryid) {
        $("#TxtuploadEntryid").val(Entryid);
    }




    $(document).ready(function () {
        $('#btnUpload').click(function () {

            Entryid =  $("#TxtuploadEntryid").val();



            ///Attach
            var fileUpload = $("#fileJOAttachment").get(0);
            var files = fileUpload.files;

            // Create FormData object
            var fileData = new FormData();


            if (files.length == 0) {
                //alert("Please select File!!")
                return false;
            }
            else {

                var iSize = document.getElementById('fileJOAttachment').files[0].size / 1024
                iSize = (Math.round((iSize / 1024) * 100) / 100)

                // Looping over all files and add it to FormData object
                for (var i = 0; i < files.length; i++) {

                    fileData.append(files[i].name, files[i]);

                }

                // Adding one more key to FormData object
                // fileData.append('username', 'Manas');
                fileData.append('Entryid', Entryid);


            }
            //attach

            $.ajax({
                url: "/Transporter/SaveTransportExpensesAttachmentToDirectory",
                type: "POST",
                contentType: false, // Not to set any content header
                processData: false, // Not to process data
                data: fileData,
                success: function (response) {

                    $("#cute-loader").fadeOut("slow");

                    alert("Record saved successfully!")
                    @* document.location = '@Url.Action("DriverSummary", "Driver")';*@
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                    $("#cute-loader").fadeOut("slow");

                }
            })


        });


    });


    function ViewExpensesAttachment(Entryid) {
        var data1 = { 'Entryid': Entryid };
        data = JSON.stringify(data1);

        $.ajax({
            url: '/Transporter/ShowExpensesattachments',
            type: "POST",
            data: data,
            contentType: false, // Not to set any content header
            processData: false, // Not to process data
            contentType: 'application/json; charset=utf-8',
            dataType: "json",
            success: function (Data) {
                $('#JOAttachment').dataTable({
                    "bLengthChange": false,
                    "bInfo": false,
                    "bPaginate": false,
                    "bFilter": false,
                    "paging": false,
                    "destroy": true,
                    "bLengthChange": false,
                    "aaData": Data,
                    "columns": [
                        { "data": "SrNo" },
                        { "data": "FilePath" },
                        {
                            "data": "DocID",
                            "render": function (data, type, row, meta) {
                                if (type === 'display') {

                                    data = '<a  onclick="DownloadAttachment(' + row.DocID + ',' + row.Entryid + ')" href="#" class="btn btn-sm btn-primary" title="View"><i class="fa fa-eye"></i> </a>';
                                    //  data = '<a  onclick="Gauri()" href=' + data + ' class="btn btn-sm btn-primary" title="View"><i class="fa fa-eye"></i> </a>';

                                    //<td><a class="btn btn-sm btn-primary" href="#" data-toggle="tooltip" title="View" onclick="ViewVisitorData()"><i class="fa fa-eye"></i> </a></td>
                                }

                                return data;
                            }


                        },
                        // { "data": "FilePath" }

                    ]
                });
                // CountRows();
                // HideColumns();

            }


        });
    }

    function DownloadAttachment(DocID, Entryid) {

        $("#hfFileId").val(DocID);
        $("#hfFileId1").val(Entryid);
        $("#btnDownload")[0].click();
       // alert(id)
    }

    $(document).ready(function () {
        AutomCom();

    });

    
        function AutomCom() {
            debugger;
            $("#ddlvendorName").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "/Transporter/getPartyNameReceipt",
                        data: "{ 'prefixText': '" + request.term + "'}",
                        dataType: "json",
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            //debugger;
                            response($.map(data, function (item) {
                                //debugger;
                                return {
                                    label: item.Name,
                                    val: item.VendorId,
                                };
                            }))
                        },
                        error: function (response) {
                            alert(response.responseText);
                        },
                        failure: function (response) {
                            alert(response.responseText);
                        }
                    })
                },
                select: function (e, i) {
                    //debugger;
                    $("#ddlvendorName").val(i.item.label);
                    $("#hdnExpensesHead").val(i.item.val);
                },
                minLength: 1
            });
        };
        
</script>

