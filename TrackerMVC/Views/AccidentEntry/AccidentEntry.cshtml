
@{
    ViewBag.Title = "AccidentEntry";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}
<script src="~/js/GetTableJson.js"></script>
<script src="~/js/GetTableArray.js"></script>

<div id="addTariff">
    <div class="page-header">
        <h4 class="page-title">Accident Entry</h4>
        <div class="form-group">
            <label class="form-label"></label>
            <div class="row gutters-xs">
                <div class="col">
                    <button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="ViewSummary();"><i class="fa fa-file-text"></i></button>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="form-horizontal">
                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Entry ID </label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input ID="txtTariffID" type="text" placeholder="New" readonly="readonly" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Entry Date</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @*<input ID="txtEffectiveFromDate" type="datetime-local"  value="@ViewBag.Date" class="form-control" />*@
                                            @*@Html.EditorFor(model => model.CHACode, new { htmlAttributes = new { @class = "form-control", @id = "chaCode", autocomplete = "off", maxlength = 20 } })*@
                                            @Html.TextBox("txtEntryDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy hh:mm") })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">

                            <div class="col-lg-3 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Accident Date</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @*<input ID="txtEffectivetoDate" type="datetime-local" value="@ViewBag.Date" class="form-control" />*@
                                            @Html.TextBox("txtAccidentDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy hh:mm") })
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>





                        <div class="row">
                            <div class="col-lg-2 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Vehicle No(Last 4 digits)</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            @Html.TextBox("txtTrailerno", null, new { @class = "form-control", @id = "Trailerno", name = "Trailerno", autocomplete = "off", placeholder = "Vehicle No", @maxlength = 4 })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12" id="divtrailernodrop">
                                <label class="form-label">Vehicle No </label>
                                <select id="ddlTrailerNo" class="form-control">
                                    <option value="">--Select--</option>
                                </select>
                            </div>

                        </div>

                        <div class="row">

                            <div class="col-lg-5 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Accident Place</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input ID="txtAccidentPlace" type="text" placeholder="Accident Place" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">

                            <div class="col-lg-5 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Driver Name</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input ID="txtDriverName" type="text" placeholder="Driver Name" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="row">

                            <div class="col-lg-5 col-sm-12">
                                <div class="form-group">
                                    <label class="form-label mandatory">Remarks (If Any)</label>
                                    <div class="row gutters-xs">
                                        <div class="col">
                                            <input ID="txtRemarks" type="text" placeholder="Remaeks" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="form-group">
                            <label class="form-label"></label>
                            <div class="row gutters-xs">
                                <div class="col">
                                    @*<input type="submit" id="Save" name="save" value="Save" class="btn btn-success" />*@
                                    <button id="btnSave" class="btn btn-success btn-xs" onclick="return Addsave();">Save</button>
                                    <input type="button" name="clear" value="Clear" class="btn btn-default" title="clear" id="clearValue" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class=" content-area" style="display:none" id="divaccidentclaime">
    <div class="page-header">
        <h4 class="page-title">Vehicle Claimm Report</h4>
        <div class="form-group">
            <label class="form-label"></label>
            <div class="row gutters-xs">
                <div class="col">
                    @*<button type="button" class="btn btn-icon btn-orange" name="gst" title="GST" id="gst"><i class="fa fa-google"></i></button>*@
                    @*<button type="button" class="btn btn-icon btn-teal" name="summarylist" title="Summary list" id="summarylist" onclick="ViewSummaryTrolley();"><i class="fa fa-file-text"></i></button>*@
                    <a onclick="window.location = '@Url.Action("AccidentEntry", "AccidentEntry")' " class="btn btn-primary btn-success text-right" style="align-content:center;color:white"><i class="fa fa-arrow-left" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Add Invoce"></i> </a>


                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="form-horizontal">
                        <div class="row">
                            <div class="row">
                                <div class="col-lg-4 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label">From Date</label>
                                        <div class="row gutters-xs">
                                            <div class="col">
                                                @Html.TextBox("FromDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.AddDays(-1).ToString("dd MMM yyyy 08:00") })

                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label"> To Date</label>
                                        <div class="row gutters-xs">
                                            <div class="col">
                                                @Html.TextBox("ToDate", null, new { @class = "form-control form_datetime1", @Value = DateTime.Now.ToString("dd MMM yyyy 07:59") })

                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-sm-12">
                                    <div class="form-group">
                                        <label class="form-label" style="visibility:hidden">.</label>
                                        <div class="row gutters-xs">
                                            <div class="col">
                                                <input type="button" id="btnShow" value="Show" class="btn btn-primary" onclick="import_View()" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>

                    @Html.ActionLink("Export To Excel", "ExportToExcelImpHC", null, new { @class = "btn btn-primary btn-md" })
                    <div class="row">
                        <div class="col-lg-12 col-sm-12">
                            <div class="table-responsive">
                                <table id="example2" class="table table-bordered table-hover tbl-cart text-nowrap" style="width:100%">
                                    <thead>

                                        <tr></tr>
                                    </thead>

                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>





<div class=" content-area">
    <div class="page-header">
        <h4 class="page-title">Last Five Record</h4>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-12">
            <div class="card">
                <div class="card-body">
                    @Html.ActionLink("Export To Excel", "ExportToExcelacidentdetails", null, new { @class = "btn btn-primary btn-md" })
                    <div class="row">
                        <div class="col-lg-12 col-sm-12">
                            <div class="table-responsive">
                                <table id="example3" class="table table-bordered table-hover tbl-cart text-nowrap" style="width:100%">
                                    <thead>

                                        <tr></tr>
                                    </thead>

                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>









<script>
    function Addsave() {

        var txtEntryDate = document.getElementById('txtEntryDate').value;
        var txtAccidentDate = document.getElementById('txtAccidentDate').value;
        var ddlTrailerNo = document.getElementById('ddlTrailerNo').value;
        var txtAccidentPlace = document.getElementById('txtAccidentPlace').value;
        var txtDriverName = document.getElementById('txtDriverName').value;
        var txtRemarks = document.getElementById('txtRemarks').value;

            //alert("hii")

        if (ddlTrailerNo == 0) {
            document.getElementById("ddlTrailerNo").style.borderColor = "red";
                alert('Please enter Vehicle No!')
                event.preventDefault();
                return;
            }


        var AccidentEntry = {};
        AccidentEntry.EntryDate = txtEntryDate;
        AccidentEntry.AccidentDate = txtAccidentDate;
        AccidentEntry.TrailerNo = ddlTrailerNo;
        AccidentEntry.AccidentPlace = txtAccidentPlace;
        AccidentEntry.DriverName = txtDriverName;
        AccidentEntry.Remarks = txtRemarks;

    $.ajax({
        url: "/AccidentEntry/Save",
        data: '{AccidentEntryEntities: ' + JSON.stringify(AccidentEntry) + '}',
    type: "POST",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (result) {
        if(JSON.stringify(result)==0)

        {
            alert('Record saved successfully');
            window.location.href = '@Url.Action("AccidentEntry", "AccidentEntry")';
        }


    },
    error: function (errormessage) {
    alert(errormessage.responseText);
    }
    });
        }


</script>
<script>
    $('#Trailerno').change(function (e) {
        var trailerno = $("#Trailerno").val();
        $.ajax({
            url: "/ManualPortOut/AjaxGetTrailerNo",
            data: '{trailerno: ' + JSON.stringify(trailerno) + '}',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {

                var select = $("#ddlTrailerNo");

                select.empty();
                select.append($('<option/>', {
                    value: "",
                    text: "--Select--"
                }));

                $.each(data, function (data, value) {

                    select.append($("<option></option>").val(value.trailerid).html(value.trailername));
                })



            },

            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });

    });
</script>


<script>
    function ViewSummary() {
        $("#addTariff").hide();
        $("#divaccidentclaime").show();
    }

    function import_View() {
        $("#tracker-loader").fadeIn("slow");

        var data = { 'fromDate': $("#FromDate").val(), 'ToDate': $("#ToDate").val() };
        data = JSON.stringify(data);
        //alert('hi')
        $.ajax({
            type: 'POST',
            url: '/AccidentEntry/GetDataBind',
            data: data,
            // data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function (jsonResult) {
                //alert("i received data");
                $("#example2").empty();
                //alert("example table cleared");
                RepTableDataJson($("#example2"), jsonResult, "Accident Entry", "AccidentEntry");
                //alert("data binded");
                $("#tracker-loader").fadeOut("slow");
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });
        //$("#divLoader").hide();
    }
</script>


<script>
    $(window).on("load", function (e) {
        Getlatestlist();
    })

    function Getlatestlist() {
        $("#tracker-loader").fadeIn("slow");

     
        //alert('hi')
        $.ajax({
            type: 'POST',
            url: '/AccidentEntry/GetDataBindDetails',
            // data: "",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function (jsonResult) {
                //alert("i received data");
                $("#example3").empty();
                //alert("example table cleared");
                RepTableDataJson($("#example3"), jsonResult, "Accident Entry", "AccidentEntry");
                //alert("data binded");
                $("#tracker-loader").fadeOut("slow");
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
                $("#tracker-loader").fadeOut("slow");
            }
        });
        //$("#divLoader").hide();
    }
</script>


